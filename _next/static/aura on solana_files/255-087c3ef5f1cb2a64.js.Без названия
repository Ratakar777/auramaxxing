(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[255],{3719:function(e,t,r){"use strict";let i,n,s,a,o,l,h,c,d,u,m,A,p,f,B,g,C,_,v,E,y,T,M;r.d(t,{B:function(){return $}});var F,R=r(2988),b=r(7776),D=r(2265),O=r(9473);/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */let x={LEFT:1,RIGHT:2,MIDDLE:4},I=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),w={NONE:0,IN:1,OUT:-1};function U(e){return e.isPerspectiveCamera}function H(e){return e.isOrthographicCamera}let G=2*Math.PI,L=Math.PI/2,S=Math.PI/180;function P(e,t,r){return Math.max(t,Math.min(r,e))}function J(e,t=1e-5){return Math.abs(e)<t}function N(e,t,r=1e-5){return J(e-t,r)}function k(e,t){return Math.round(e/t)*t}function K(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Q(e){return Math.abs(e)<Number.MAX_VALUE?e:1/0*e}function j(e,t,r,i,n=1/0,s){let a=2/(i=Math.max(1e-4,i)),o=a*s,l=1/(1+o+.48*o*o+.235*o*o*o),h=e-t,c=t,d=n*i;t=e-(h=P(h,-d,d));let u=(r.value+a*h)*s;r.value=(r.value-a*u)*l;let m=t+(h+u)*l;return c-e>0==m>c&&(m=c,r.value=(m-c)/s),m}function Y(e,t,r,i,n=1/0,s,a){let o=2/(i=Math.max(1e-4,i)),l=o*s,h=1/(1+l+.48*l*l+.235*l*l*l),c=t.x,d=t.y,u=t.z,m=e.x-c,A=e.y-d,p=e.z-u,f=c,B=d,g=u,C=n*i,_=m*m+A*A+p*p;if(_>C*C){let e=Math.sqrt(_);m=m/e*C,A=A/e*C,p=p/e*C}c=e.x-m,d=e.y-A,u=e.z-p;let v=(r.x+o*m)*s,E=(r.y+o*A)*s,y=(r.z+o*p)*s;r.x=(r.x-o*v)*h,r.y=(r.y-o*E)*h,r.z=(r.z-o*y)*h,a.x=c+(m+v)*h,a.y=d+(A+E)*h,a.z=u+(p+y)*h;let T=f-e.x,M=B-e.y,F=g-e.z;return T*(a.x-f)+M*(a.y-B)+F*(a.z-g)>0&&(a.x=f,a.y=B,a.z=g,r.x=(a.x-f)/s,r.y=(a.y-B)/s,r.z=(a.z-g)/s),a}function X(e,t){t.set(0,0),e.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=e.length,t.y/=e.length}function V(e,t){return!!H(e)&&(console.warn(`${t} is not supported in OrthographicCamera`),!0)}class z{constructor(){this._listeners={}}addEventListener(e,t){let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){let r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){let t=this._listeners[e.type];if(void 0!==t){e.target=this;let r=t.slice(0);for(let t=0,i=r.length;t<i;t++)r[t].call(this,e)}}}let Z=1/8,W=/Mac/.test(null===(F=null==globalThis?void 0:globalThis.navigator)||void 0===F?void 0:F.platform);class q extends z{static install(e){n=Object.freeze(new(i=e.THREE).Vector3(0,0,0)),s=Object.freeze(new i.Vector3(0,1,0)),a=Object.freeze(new i.Vector3(0,0,1)),o=new i.Vector2,l=new i.Vector3,h=new i.Vector3,c=new i.Vector3,d=new i.Vector3,u=new i.Vector3,m=new i.Vector3,A=new i.Vector3,p=new i.Vector3,f=new i.Vector3,B=new i.Spherical,g=new i.Spherical,C=new i.Box3,_=new i.Box3,v=new i.Sphere,E=new i.Quaternion,y=new i.Quaternion,T=new i.Matrix4,M=new i.Raycaster}static get ACTION(){return I}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=I.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=w.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new i.Vector3,this._focalOffsetVelocity=new i.Vector3,this._zoomVelocity={value:0},this._truckInternal=(e,t,r)=>{let i,n;if(U(this._camera)){let r=l.copy(this._camera.position).sub(this._target),s=this._camera.getEffectiveFOV()*S,a=r.length()*Math.tan(.5*s);i=this.truckSpeed*e*a/this._elementRect.height,n=this.truckSpeed*t*a/this._elementRect.height}else{if(!H(this._camera))return;let r=this._camera;i=e*(r.right-r.left)/r.zoom/this._elementRect.width,n=t*(r.top-r.bottom)/r.zoom/this._elementRect.height}this.verticalDragToForward?(r?this.setFocalOffset(this._focalOffsetEnd.x+i,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(i,0,!0),this.forward(-n,!0)):r?this.setFocalOffset(this._focalOffsetEnd.x+i,this._focalOffsetEnd.y+n,this._focalOffsetEnd.z,!0):this.truck(i,n,!0)},this._rotateInternal=(e,t)=>{let r=G*this.azimuthRotateSpeed*e/this._elementRect.height,i=G*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(r,i,!0)},this._dollyInternal=(e,t,r)=>{let i=Math.pow(.95,-e*this.dollySpeed),n=this._sphericalEnd.radius,s=this._sphericalEnd.radius*i,a=P(s,this.minDistance,this.maxDistance);this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(s,!0):(this.infinityDolly&&!this.dollyToCursor&&this.dollyInFixed(a-s,!0),this._dollyToNoClamp(a,!0)),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?s:a)-n,this._dollyControlCoord.set(t,r)),this._lastDollyDirection=Math.sign(-e)},this._zoomInternal=(e,t,r)=>{let i=Math.pow(.95,e*this.dollySpeed),n=this._zoom,s=this._zoom*i;this.zoomTo(s,!0),this.dollyToCursor&&(this._changedZoom+=s-n,this._dollyControlCoord.set(t,r))},void 0===i&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new i.Quaternion().setFromUnitVectors(this._camera.up,s),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=I.NONE,this._target=new i.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new i.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new i.Spherical().setFromVector3(l.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3],this._updateNearPlaneCorners(),this._boundary=new i.Box3(new i.Vector3(-1/0,-1/0,-1/0),new i.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new i.Vector2,this.mouseButtons={left:I.ROTATE,middle:I.DOLLY,right:I.TRUCK,wheel:U(this._camera)?I.DOLLY:H(this._camera)?I.ZOOM:I.NONE},this.touches={one:I.TOUCH_ROTATE,two:U(this._camera)?I.TOUCH_DOLLY_TRUCK:H(this._camera)?I.TOUCH_ZOOM_TRUCK:I.NONE,three:I.TOUCH_TRUCK};let r=new i.Vector2,n=new i.Vector2,a=new i.Vector2,h=e=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let t=this._domElement.getBoundingClientRect(),r=e.clientX/t.width,i=e.clientY/t.height;if(r<this._interactiveArea.left||r>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}let t="mouse"!==e.pointerType?null:(e.buttons&x.LEFT)===x.LEFT?x.LEFT:(e.buttons&x.MIDDLE)===x.MIDDLE?x.MIDDLE:(e.buttons&x.RIGHT)===x.RIGHT?x.RIGHT:null;if(null!==t){let e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}if((e.buttons&x.LEFT)===x.LEFT&&this._lockedPointer)return;let r={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:t};this._activePointers.push(r),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",d),this._isDragging=!0,p(e)},c=e=>{e.cancelable&&e.preventDefault();let t=e.pointerId,r=this._lockedPointer||this._findPointerById(t);if(r){if(r.clientX=e.clientX,r.clientY=e.clientY,r.deltaX=e.movementX,r.deltaY=e.movementY,this._state=0,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(e.buttons&x.LEFT)===x.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(e.buttons&x.MIDDLE)===x.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(e.buttons&x.RIGHT)===x.RIGHT&&(this._state=this._state|this.mouseButtons.right);f()}},d=e=>{let t=this._findPointerById(e.pointerId);if(!t||t!==this._lockedPointer){if(t&&this._disposePointer(t),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=I.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=I.NONE;B()}},u=-1,m=e=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===I.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let t=this._domElement.getBoundingClientRect(),r=e.clientX/t.width,i=e.clientY/t.height;if(r<this._interactiveArea.left||r>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===I.ROTATE||this.mouseButtons.wheel===I.TRUCK){let e=performance.now();u-e<1e3&&this._getClientRect(this._elementRect),u=e}let t=W?-1:-3,r=1===e.deltaMode?e.deltaY/t:e.deltaY/(10*t),i=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,n=this.dollyToCursor?-((e.clientY-this._elementRect.y)/this._elementRect.height*2)+1:0;switch(this.mouseButtons.wheel){case I.ROTATE:this._rotateInternal(e.deltaX,e.deltaY),this._isUserControllingRotate=!0;break;case I.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1),this._isUserControllingTruck=!0;break;case I.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0),this._isUserControllingOffset=!0;break;case I.DOLLY:this._dollyInternal(-r,i,n),this._isUserControllingDolly=!0;break;case I.ZOOM:this._zoomInternal(-r,i,n),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},A=e=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===q.ACTION.NONE){let t=e instanceof PointerEvent?e.pointerId:0,r=this._findPointerById(t);r&&this._disposePointer(r),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d);return}e.preventDefault()}},p=e=>{if(this._enabled){if(X(this._activePointers,o),this._getClientRect(this._elementRect),r.copy(o),n.copy(o),this._activePointers.length>=2){let e=o.x-this._activePointers[1].clientX,t=o.y-this._activePointers[1].clientY;a.set(0,Math.sqrt(e*e+t*t));let r=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,i=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;n.set(r,i)}if(this._state=0,e){if("pointerType"in e&&"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._lockedPointer||(e.buttons&x.LEFT)!==x.LEFT||(this._state=this._state|this.mouseButtons.left),(e.buttons&x.MIDDLE)===x.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&x.RIGHT)===x.RIGHT&&(this._state=this._state|this.mouseButtons.right)}else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);((this._state&I.ROTATE)===I.ROTATE||(this._state&I.TOUCH_ROTATE)===I.TOUCH_ROTATE||(this._state&I.TOUCH_DOLLY_ROTATE)===I.TOUCH_DOLLY_ROTATE||(this._state&I.TOUCH_ZOOM_ROTATE)===I.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&I.TRUCK)===I.TRUCK||(this._state&I.TOUCH_TRUCK)===I.TOUCH_TRUCK||(this._state&I.TOUCH_DOLLY_TRUCK)===I.TOUCH_DOLLY_TRUCK||(this._state&I.TOUCH_ZOOM_TRUCK)===I.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&I.DOLLY)===I.DOLLY||(this._state&I.TOUCH_DOLLY)===I.TOUCH_DOLLY||(this._state&I.TOUCH_DOLLY_TRUCK)===I.TOUCH_DOLLY_TRUCK||(this._state&I.TOUCH_DOLLY_OFFSET)===I.TOUCH_DOLLY_OFFSET||(this._state&I.TOUCH_DOLLY_ROTATE)===I.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&I.ZOOM)===I.ZOOM||(this._state&I.TOUCH_ZOOM)===I.TOUCH_ZOOM||(this._state&I.TOUCH_ZOOM_TRUCK)===I.TOUCH_ZOOM_TRUCK||(this._state&I.TOUCH_ZOOM_OFFSET)===I.TOUCH_ZOOM_OFFSET||(this._state&I.TOUCH_ZOOM_ROTATE)===I.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&I.OFFSET)===I.OFFSET||(this._state&I.TOUCH_OFFSET)===I.TOUCH_OFFSET||(this._state&I.TOUCH_DOLLY_OFFSET)===I.TOUCH_DOLLY_OFFSET||(this._state&I.TOUCH_ZOOM_OFFSET)===I.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},f=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,X(this._activePointers,o);let e=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,t=e?-e.deltaX:n.x-o.x,i=e?-e.deltaY:n.y-o.y;if(n.copy(o),((this._state&I.ROTATE)===I.ROTATE||(this._state&I.TOUCH_ROTATE)===I.TOUCH_ROTATE||(this._state&I.TOUCH_DOLLY_ROTATE)===I.TOUCH_DOLLY_ROTATE||(this._state&I.TOUCH_ZOOM_ROTATE)===I.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(t,i),this._isUserControllingRotate=!0),(this._state&I.DOLLY)===I.DOLLY||(this._state&I.ZOOM)===I.ZOOM){let e=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,t=this.dollyToCursor?-((r.y-this._elementRect.y)/this._elementRect.height*2)+1:0,n=this.dollyDragInverted?-1:1;(this._state&I.DOLLY)===I.DOLLY?(this._dollyInternal(n*i*Z,e,t),this._isUserControllingDolly=!0):(this._zoomInternal(n*i*Z,e,t),this._isUserControllingZoom=!0)}if((this._state&I.TOUCH_DOLLY)===I.TOUCH_DOLLY||(this._state&I.TOUCH_ZOOM)===I.TOUCH_ZOOM||(this._state&I.TOUCH_DOLLY_TRUCK)===I.TOUCH_DOLLY_TRUCK||(this._state&I.TOUCH_ZOOM_TRUCK)===I.TOUCH_ZOOM_TRUCK||(this._state&I.TOUCH_DOLLY_OFFSET)===I.TOUCH_DOLLY_OFFSET||(this._state&I.TOUCH_ZOOM_OFFSET)===I.TOUCH_ZOOM_OFFSET||(this._state&I.TOUCH_DOLLY_ROTATE)===I.TOUCH_DOLLY_ROTATE||(this._state&I.TOUCH_ZOOM_ROTATE)===I.TOUCH_ZOOM_ROTATE){let e=o.x-this._activePointers[1].clientX,t=o.y-this._activePointers[1].clientY,r=Math.sqrt(e*e+t*t),i=a.y-r;a.set(0,r);let s=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,l=this.dollyToCursor?-((n.y-this._elementRect.y)/this._elementRect.height*2)+1:0;(this._state&I.TOUCH_DOLLY)===I.TOUCH_DOLLY||(this._state&I.TOUCH_DOLLY_ROTATE)===I.TOUCH_DOLLY_ROTATE||(this._state&I.TOUCH_DOLLY_TRUCK)===I.TOUCH_DOLLY_TRUCK||(this._state&I.TOUCH_DOLLY_OFFSET)===I.TOUCH_DOLLY_OFFSET?(this._dollyInternal(i*Z,s,l),this._isUserControllingDolly=!0):(this._zoomInternal(i*Z,s,l),this._isUserControllingZoom=!0)}((this._state&I.TRUCK)===I.TRUCK||(this._state&I.TOUCH_TRUCK)===I.TOUCH_TRUCK||(this._state&I.TOUCH_DOLLY_TRUCK)===I.TOUCH_DOLLY_TRUCK||(this._state&I.TOUCH_ZOOM_TRUCK)===I.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(t,i,!1),this._isUserControllingTruck=!0),((this._state&I.OFFSET)===I.OFFSET||(this._state&I.TOUCH_OFFSET)===I.TOUCH_OFFSET||(this._state&I.TOUCH_DOLLY_OFFSET)===I.TOUCH_DOLLY_OFFSET||(this._state&I.TOUCH_ZOOM_OFFSET)===I.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(t,i,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},B=()=>{X(this._activePointers,o),n.copy(o),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{this._enabled&&this._domElement&&(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",g),this._domElement.ownerDocument.addEventListener("pointerlockerror",C),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",d),p())},this.unlockPointer=()=>{var e,t,r;null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),null===(e=this._domElement)||void 0===e||e.ownerDocument.exitPointerLock(),null===(t=this._domElement)||void 0===t||t.ownerDocument.removeEventListener("pointerlockchange",g),null===(r=this._domElement)||void 0===r||r.ownerDocument.removeEventListener("pointerlockerror",C),this.cancel()};let g=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},C=()=>{this.unlockPointer()};this._addAllEventListeners=e=>{this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",h),this._domElement.addEventListener("pointercancel",d),this._domElement.addEventListener("wheel",m,{passive:!1}),this._domElement.addEventListener("contextmenu",A)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",h),this._domElement.removeEventListener("pointercancel",d),this._domElement.removeEventListener("wheel",m,{passive:!1}),this._domElement.removeEventListener("contextmenu",A),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.removeEventListener("pointerlockchange",g),this._domElement.ownerDocument.removeEventListener("pointerlockerror",C))},this.cancel=()=>{this._state!==I.NONE&&(this._state=I.NONE,this._activePointers.length=0,B())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){(this._spherical.radius!==e||this._sphericalEnd.radius!==e)&&(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){(this._spherical.theta!==e||this._sphericalEnd.theta!==e)&&(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){(this._spherical.phi!==e||this._sphericalEnd.phi!==e)&&(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=P(e.width,0,1),this._interactiveArea.height=P(e.height,0,1),this._interactiveArea.x=P(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=P(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,r=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,r)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,r=!1){this._isUserControllingRotate=!1;let i=P(e,this.minAzimuthAngle,this.maxAzimuthAngle),n=P(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=n,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,r||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);let s=!r||N(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&N(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(s)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=w.NONE,this._changedDolly=0,this._dollyToNoClamp(P(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){let r=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){let t=this._collisionTest(),i=N(t,this._spherical.radius);if(!(r>e)&&i)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,t)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);let i=!t||N(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(d).multiplyScalar(e)),t||this._target.copy(this._targetEnd);let r=!t||N(this._target.x,this._targetEnd.x,this.restThreshold)&&N(this._target.y,this._targetEnd.y,this.restThreshold)&&N(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=P(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);let r=!t||N(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(r)}pan(e,t,r=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,r)}truck(e,t,r=!1){this._camera.updateMatrix(),u.setFromMatrixColumn(this._camera.matrix,0),m.setFromMatrixColumn(this._camera.matrix,1),u.multiplyScalar(e),m.multiplyScalar(-t);let i=l.copy(u).add(m),n=h.copy(this._targetEnd).add(i);return this.moveTo(n.x,n.y,n.z,r)}forward(e,t=!1){l.setFromMatrixColumn(this._camera.matrix,0),l.crossVectors(this._camera.up,l),l.multiplyScalar(e);let r=h.copy(this._targetEnd).add(l);return this.moveTo(r.x,r.y,r.z,t)}elevate(e,t=!1){return l.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+l.x,this._targetEnd.y+l.y,this._targetEnd.z+l.z,t)}moveTo(e,t,r,i=!1){this._isUserControllingTruck=!1;let n=l.set(e,t,r).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,n,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);let s=!i||N(this._target.x,this._targetEnd.x,this.restThreshold)&&N(this._target.y,this._targetEnd.y,this.restThreshold)&&N(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}lookInDirectionOf(e,t,r,i=!1){let n=l.set(e,t,r).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(n.x,n.y,n.z,i)}fitToBox(e,t,{cover:r=!1,paddingLeft:i=0,paddingRight:n=0,paddingBottom:o=0,paddingTop:c=0}={}){let d=[],u=e.isBox3?C.copy(e):C.setFromObject(e);u.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());let m=k(this._sphericalEnd.theta,L),A=k(this._sphericalEnd.phi,L);d.push(this.rotateTo(m,A,t));let p=l.setFromSpherical(this._sphericalEnd).normalize(),f=E.setFromUnitVectors(p,a),B=N(Math.abs(p.y),1);B&&f.multiply(y.setFromAxisAngle(s,m)),f.multiply(this._yAxisUpSpaceInverse);let g=_.makeEmpty();h.copy(u.min).applyQuaternion(f),g.expandByPoint(h),h.copy(u.min).setX(u.max.x).applyQuaternion(f),g.expandByPoint(h),h.copy(u.min).setY(u.max.y).applyQuaternion(f),g.expandByPoint(h),h.copy(u.max).setZ(u.min.z).applyQuaternion(f),g.expandByPoint(h),h.copy(u.min).setZ(u.max.z).applyQuaternion(f),g.expandByPoint(h),h.copy(u.max).setY(u.min.y).applyQuaternion(f),g.expandByPoint(h),h.copy(u.max).setX(u.min.x).applyQuaternion(f),g.expandByPoint(h),h.copy(u.max).applyQuaternion(f),g.expandByPoint(h),g.min.x-=i,g.min.y-=o,g.max.x+=n,g.max.y+=c,f.setFromUnitVectors(a,p),B&&f.premultiply(y.invert()),f.premultiply(this._yAxisUpSpace);let v=g.getSize(l),T=g.getCenter(h).applyQuaternion(f);if(U(this._camera)){let e=this.getDistanceToFitBox(v.x,v.y,v.z,r);d.push(this.moveTo(T.x,T.y,T.z,t)),d.push(this.dollyTo(e,t)),d.push(this.setFocalOffset(0,0,0,t))}else if(H(this._camera)){let e=this._camera,i=e.right-e.left,n=e.top-e.bottom,s=r?Math.max(i/v.x,n/v.y):Math.min(i/v.x,n/v.y);d.push(this.moveTo(T.x,T.y,T.z,t)),d.push(this.zoomTo(s,t)),d.push(this.setFocalOffset(0,0,0,t))}return Promise.all(d)}fitToSphere(e,t){let r=[],i="isObject3D"in e?q.createBoundingSphere(e,v):v.copy(e);if(r.push(this.moveTo(i.center.x,i.center.y,i.center.z,t)),U(this._camera)){let e=this.getDistanceToFitSphere(i.radius);r.push(this.dollyTo(e,t))}else if(H(this._camera)){let e=this._camera.right-this._camera.left,n=this._camera.top-this._camera.bottom,s=2*i.radius;r.push(this.zoomTo(Math.min(e/s,n/s),t))}return r.push(this.setFocalOffset(0,0,0,t)),Promise.all(r)}setLookAt(e,t,r,i,n,s,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=w.NONE,this._changedDolly=0;let o=h.set(i,n,s),c=l.set(e,t,r);this._targetEnd.copy(o),this._sphericalEnd.setFromVector3(c.sub(o).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let d=!a||N(this._target.x,this._targetEnd.x,this.restThreshold)&&N(this._target.y,this._targetEnd.y,this.restThreshold)&&N(this._target.z,this._targetEnd.z,this.restThreshold)&&N(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&N(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&N(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(d)}lerpLookAt(e,t,r,i,n,s,a,o,d,u,m,A,p,f=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=w.NONE,this._changedDolly=0;let C=l.set(i,n,s),_=h.set(e,t,r);B.setFromVector3(_.sub(C).applyQuaternion(this._yAxisUpSpace));let v=c.set(u,m,A),E=h.set(a,o,d);g.setFromVector3(E.sub(v).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(C.lerp(v,p));let y=g.theta-B.theta,T=g.phi-B.phi,M=g.radius-B.radius;this._sphericalEnd.set(B.radius+M*p,B.phi+T*p,B.theta+y*p),this.normalizeRotations(),this._needsUpdate=!0,f||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let F=!f||N(this._target.x,this._targetEnd.x,this.restThreshold)&&N(this._target.y,this._targetEnd.y,this.restThreshold)&&N(this._target.z,this._targetEnd.z,this.restThreshold)&&N(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&N(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&N(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(F)}setPosition(e,t,r,i=!1){return this.setLookAt(e,t,r,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(e,t,r,i=!1){let n=this.getPosition(l),s=this.setLookAt(n.x,n.y,n.z,e,t,r,i);return this._sphericalEnd.phi=P(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),s}setFocalOffset(e,t,r,i=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,r),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);let n=!i||N(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&N(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&N(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}setOrbitPoint(e,t,r){this._camera.updateMatrixWorld(),u.setFromMatrixColumn(this._camera.matrixWorldInverse,0),m.setFromMatrixColumn(this._camera.matrixWorldInverse,1),A.setFromMatrixColumn(this._camera.matrixWorldInverse,2);let i=l.set(e,t,r),n=i.distanceTo(this._camera.position),s=i.sub(this._camera.position);u.multiplyScalar(s.x),m.multiplyScalar(s.y),A.multiplyScalar(s.z),l.copy(u).add(m).add(A),l.z=l.z+n,this.dollyTo(n,!1),this.setFocalOffset(-l.x,l.y,-l.z,!1),this.moveTo(e,t,r,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,r,n){if(null===e){this._viewport=null;return}this._viewport=this._viewport||new i.Vector4,"number"==typeof e?this._viewport.set(e,t,r,n):this._viewport.copy(e)}getDistanceToFitBox(e,t,r,i=!1){if(V(this._camera,"getDistanceToFitBox"))return this._spherical.radius;let n=e/t,s=this._camera.getEffectiveFOV()*S,a=this._camera.aspect;return .5*((i?n>a:n<a)?t:e/a)/Math.tan(.5*s)+.5*r}getDistanceToFitSphere(e){if(V(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;let t=this._camera.getEffectiveFOV()*S,r=2*Math.atan(Math.tan(.5*t)*this._camera.aspect);return e/Math.sin(.5*(1<this._camera.aspect?t:r))}getTarget(e,t=!0){return(e&&e.isVector3?e:new i.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new i.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new i.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new i.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%G,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=G),this._spherical.theta+=G*Math.round((this._sphericalEnd.theta-this._spherical.theta)/G)}reset(e=!1){if(!N(this._camera.up.x,this._cameraUp0.x)||!N(this._camera.up.y,this._cameraUp0.y)||!N(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);let e=this.getPosition(l);this.updateCameraUp(),this.setPosition(e.x,e.y,e.z)}return Promise.all([this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)])}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,s),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){let e=l.subVectors(this._target,this._camera.position).normalize(),t=h.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();let r=this.getPosition(l);this.updateCameraUp(),this.setPosition(r.x,r.y,r.z)}update(e){let t=this._sphericalEnd.theta-this._spherical.theta,r=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,n=p.subVectors(this._targetEnd,this._target),s=f.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(J(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{let t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=j(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,t,1/0,e),this._needsUpdate=!0}if(J(r))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{let t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=j(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,t,1/0,e),this._needsUpdate=!0}if(J(i))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{let t=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=j(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,t,this.maxSpeed,e),this._needsUpdate=!0}if(J(n.x)&&J(n.y)&&J(n.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{let t=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;Y(this._target,this._targetEnd,this._targetVelocity,t,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(J(s.x)&&J(s.y)&&J(s.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{let t=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;Y(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,t,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(J(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{let t=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=j(this._zoom,this._zoomEnd,this._zoomVelocity,t,1/0,e)}if(this.dollyToCursor){if(U(this._camera)&&0!==this._changedDolly){let e=this._spherical.radius-this._lastDistance,t=this._camera,r=this._getCameraDirection(d),i=l.copy(r).cross(t.up).normalize();0===i.lengthSq()&&(i.x=1);let n=h.crossVectors(i,r),s=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*S*.5),a=(this._sphericalEnd.radius-e-this._sphericalEnd.radius)/this._sphericalEnd.radius,o=c.copy(this._targetEnd).add(i.multiplyScalar(this._dollyControlCoord.x*s*t.aspect)).add(n.multiplyScalar(this._dollyControlCoord.y*s)),u=l.copy(this._targetEnd).lerp(o,a),m=this._lastDollyDirection===w.IN&&this._spherical.radius<=this.minDistance,A=this._lastDollyDirection===w.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(m||A)){this._sphericalEnd.radius-=e,this._spherical.radius-=e;let t=h.copy(r).multiplyScalar(-e);u.add(t)}this._boundary.clampPoint(u,u);let p=h.subVectors(u,this._targetEnd);this._targetEnd.copy(u),this._target.add(p),this._changedDolly-=e,J(this._changedDolly)&&(this._changedDolly=0)}else if(H(this._camera)&&0!==this._changedZoom){let e=this._zoom-this._lastZoom,t=this._camera,r=l.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),i=h.set(0,0,-1).applyQuaternion(t.quaternion),n=c.copy(r).add(i.multiplyScalar(-r.dot(t.up))),s=-(this._zoom-e-this._zoom)/this._zoom,a=this._getCameraDirection(d),o=this._targetEnd.dot(a),u=l.copy(this._targetEnd).lerp(n,s),m=u.dot(a),A=a.multiplyScalar(m-o);u.sub(A),this._boundary.clampPoint(u,u);let p=h.subVectors(u,this._targetEnd);this._targetEnd.copy(u),this._target.add(p),this._changedZoom-=e,J(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;let o=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,o),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),J(this._focalOffset.x)&&J(this._focalOffset.y)&&J(this._focalOffset.z)||(this._camera.updateMatrixWorld(),u.setFromMatrixColumn(this._camera.matrix,0),m.setFromMatrixColumn(this._camera.matrix,1),A.setFromMatrixColumn(this._camera.matrix,2),u.multiplyScalar(this._focalOffset.x),m.multiplyScalar(-this._focalOffset.y),A.multiplyScalar(this._focalOffset.z),l.copy(u).add(m).add(A),this._camera.position.add(l)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),l.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);let B=this._needsUpdate;return B&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):B?(this.dispatchEvent({type:"update"}),J(t,this.restThreshold)&&J(r,this.restThreshold)&&J(i,this.restThreshold)&&J(n.x,this.restThreshold)&&J(n.y,this.restThreshold)&&J(n.z,this.restThreshold)&&J(s.x,this.restThreshold)&&J(s.y,this.restThreshold)&&J(s.z,this.restThreshold)&&J(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!B&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=B,this._needsUpdate=!1,B}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:K(this.maxDistance),minZoom:this.minZoom,maxZoom:K(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:K(this.maxPolarAngle),minAzimuthAngle:K(this.minAzimuthAngle),maxAzimuthAngle:K(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:l.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){let r=JSON.parse(e);this.enabled=r.enabled,this.minDistance=r.minDistance,this.maxDistance=Q(r.maxDistance),this.minZoom=r.minZoom,this.maxZoom=Q(r.maxZoom),this.minPolarAngle=r.minPolarAngle,this.maxPolarAngle=Q(r.maxPolarAngle),this.minAzimuthAngle=Q(r.minAzimuthAngle),this.maxAzimuthAngle=Q(r.maxAzimuthAngle),this.smoothTime=r.smoothTime,this.draggingSmoothTime=r.draggingSmoothTime,this.dollySpeed=r.dollySpeed,this.truckSpeed=r.truckSpeed,this.dollyToCursor=r.dollyToCursor,this.verticalDragToForward=r.verticalDragToForward,this._target0.fromArray(r.target0),this._position0.fromArray(r.position0),this._zoom0=r.zoom0,this._focalOffset0.fromArray(r.focalOffset0),this.moveTo(r.target[0],r.target[1],r.target[2],t),B.setFromVector3(l.fromArray(r.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(B.theta,B.phi,t),this.dollyTo(B.radius,t),this.zoomTo(r.zoom,t),this.setFocalOffset(r.focalOffset[0],r.focalOffset[1],r.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version","2.8.5"),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,r){let i=t.lengthSq();if(0===i)return e;let n=h.copy(t).add(e),s=this._boundary.clampPoint(n,c).sub(n),a=s.lengthSq();if(0===a)return e.add(t);if(a===i)return e;if(0===r)return e.add(t).add(s);{let i=1+r*a/t.dot(s);return e.add(h.copy(t).multiplyScalar(i)).add(s.multiplyScalar(1-r))}}_updateNearPlaneCorners(){if(U(this._camera)){let e=this._camera,t=e.near,r=Math.tan(e.getEffectiveFOV()*S*.5)*t,i=r*e.aspect;this._nearPlaneCorners[0].set(-i,-r,0),this._nearPlaneCorners[1].set(i,-r,0),this._nearPlaneCorners[2].set(i,r,0),this._nearPlaneCorners[3].set(-i,r,0)}else if(H(this._camera)){let e=this._camera,t=1/e.zoom,r=e.left*t,i=e.right*t,n=e.top*t,s=e.bottom*t;this._nearPlaneCorners[0].set(r,n,0),this._nearPlaneCorners[1].set(i,n,0),this._nearPlaneCorners[2].set(i,s,0),this._nearPlaneCorners[3].set(r,s,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||V(this._camera,"_collisionTest"))return e;let t=this._getTargetDirection(d);T.lookAt(n,t,this._camera.up);for(let r=0;r<4;r++){let i=h.copy(this._nearPlaneCorners[r]);i.applyMatrix4(T);let n=c.addVectors(this._target,i);M.set(n,t),M.far=this._spherical.radius+1;let s=M.intersectObjects(this.colliderMeshes);0!==s.length&&s[0].distance<e&&(e=s[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;let t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{let t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new i.Sphere){let r=t.center;C.makeEmpty(),e.traverseVisible(e=>{e.isMesh&&C.expandByObject(e)}),C.getCenter(r);let n=0;return e.traverseVisible(e=>{if(!e.isMesh)return;let t=e.geometry.clone();t.applyMatrix4(e.matrixWorld);let i=t.attributes.position;for(let e=0,t=i.count;e<t;e++)l.fromBufferAttribute(i,e),n=Math.max(n,r.distanceToSquared(l))}),t.radius=Math.sqrt(n),t}}let $=(0,D.forwardRef)((e,t)=>{(0,D.useMemo)(()=>{let e={Box3:b.Box3,MathUtils:{clamp:b.MathUtils.clamp},Matrix4:b.Matrix4,Quaternion:b.Quaternion,Raycaster:b.Raycaster,Sphere:b.Sphere,Spherical:b.Spherical,Vector2:b.Vector2,Vector3:b.Vector3,Vector4:b.Vector4};q.install({THREE:e}),(0,O.e)({CameraControlsImpl:q})},[]);let{camera:r,domElement:i,makeDefault:n,onStart:s,onEnd:a,onChange:o,regress:l,...h}=e,c=(0,O.A)(e=>e.camera),d=(0,O.A)(e=>e.gl),u=(0,O.A)(e=>e.invalidate),m=(0,O.A)(e=>e.events),A=(0,O.A)(e=>e.setEvents),p=(0,O.A)(e=>e.set),f=(0,O.A)(e=>e.get),B=(0,O.A)(e=>e.performance),g=r||c,C=i||m.connected||d.domElement,_=(0,D.useMemo)(()=>new q(g),[g]);return(0,O.C)((e,t)=>{_.enabled&&_.update(t)},-1),(0,D.useEffect)(()=>(_.connect(C),()=>void _.disconnect()),[C,_]),(0,D.useEffect)(()=>{let e=e=>{u(),l&&B.regress(),o&&o(e)},t=e=>{s&&s(e)},r=e=>{a&&a(e)};return _.addEventListener("update",e),_.addEventListener("controlstart",t),_.addEventListener("controlend",r),_.addEventListener("control",e),_.addEventListener("transitionstart",e),_.addEventListener("wake",e),()=>{_.removeEventListener("update",e),_.removeEventListener("controlstart",t),_.removeEventListener("controlend",r),_.removeEventListener("control",e),_.removeEventListener("transitionstart",e),_.removeEventListener("wake",e)}},[_,s,a,u,A,l,o]),(0,D.useEffect)(()=>{if(n){let e=f().controls;return p({controls:_}),()=>p({controls:e})}},[n,_]),D.createElement("primitive",(0,R.Z)({ref:t,object:_},h))})},8388:function(e,t,r){"use strict";let i;r.d(t,{ZJ:function(){return M},lc:function(){return y}});var n=r(2988),s=r(2265),a=r(7776),o=r(9473);let l=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function h(e,t){let r=(0,o.A)(e=>e.gl),i=(0,o.F)(a.TextureLoader,l(e)?Object.values(e):e);return(0,s.useLayoutEffect)(()=>{null==t||t(i)},[t]),(0,s.useEffect)(()=>{if("initTexture"in r){let e=[];Array.isArray(i)?e=i:i instanceof a.Texture?e=[i]:l(i)&&(e=Object.values(i)),e.forEach(e=>{e instanceof a.Texture&&r.initTexture(e)})}},[r,i]),(0,s.useMemo)(()=>{if(!l(e))return i;{let t={},r=0;for(let n in e)t[n]=i[r++];return t}},[e,i])}h.preload=e=>o.F.preload(a.TextureLoader,e),h.clear=e=>o.F.clear(a.TextureLoader,e);var c={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let d=new Uint8Array(16),u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));var m=function(e,t,r){if(c.randomUUID&&!t&&!e)return c.randomUUID();let n=(e=e||{}).random||(e.rng||function(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(d)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]}(n)},A=r(6078);let p="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",f=new a.Matrix4,B=new a.Vector3,g=new a.Quaternion,C=new a.Vector3,_=new a.Quaternion,v=new a.Vector3,E=s.createContext(null),y=s.forwardRef(({children:e,material:t=a.MeshLambertMaterial,texture:r=p,range:i,limit:l=200,frustumCulled:c,...d},u)=>{var m,y;let T;let M=s.useMemo(()=>class extends t{constructor(){super();let e=parseInt(a.REVISION.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=t=>{t.vertexShader=`attribute float opacity;
               varying float vOpacity;
              `+t.vertexShader.replace("#include <fog_vertex>",`#include <fog_vertex>
                 vOpacity = opacity;
                `),t.fragmentShader=`varying float vOpacity;
              `+t.fragmentShader.replace(`#include <${e}>`,`#include <${e}>
                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);
                `)}}},[t]);(0,o.e)({CloudMaterial:M});let F=s.useRef(null),R=s.useRef([]),b=s.useMemo(()=>new Float32Array(Array.from({length:l},()=>1)),[l]),D=s.useMemo(()=>new Float32Array(Array.from({length:l},()=>[1,1,1]).flat()),[l]),O=h(r),x=0,I=0,w=new a.Quaternion,U=new a.Vector3(0,0,1),H=new a.Vector3;(0,o.C)((e,t)=>{for(x=e.clock.getElapsedTime(),f.copy(F.current.matrixWorld).invert(),e.camera.matrixWorld.decompose(C,_,v),I=0;I<R.current.length;I++)(T=R.current[I]).ref.current.matrixWorld.decompose(B,g,v),B.add(H.copy(T.position).applyQuaternion(g).multiply(v)),g.copy(_).multiply(w.setFromAxisAngle(U,T.rotation+=t*T.rotationFactor)),v.multiplyScalar(T.volume+(1+Math.sin(x*T.density*T.speed))/2*T.growth),T.matrix.compose(B,g,v).premultiply(f),T.dist=B.distanceTo(C);for(R.current.sort((e,t)=>t.dist-e.dist),I=0;I<R.current.length;I++)T=R.current[I],b[I]=T.opacity*(T.dist<T.fade-1?T.dist/T.fade:1),F.current.setMatrixAt(I,T.matrix),F.current.setColorAt(I,T.color);F.current.geometry.attributes.opacity.needsUpdate=!0,F.current.instanceMatrix.needsUpdate=!0,F.current.instanceColor&&(F.current.instanceColor.needsUpdate=!0)}),s.useLayoutEffect(()=>{let e=Math.min(l,void 0!==i?i:l,R.current.length);F.current.count=e,(0,A.Jj)(F.current.instanceMatrix,{offset:0,count:16*e}),F.current.instanceColor&&(0,A.Jj)(F.current.instanceColor,{offset:0,count:3*e}),(0,A.Jj)(F.current.geometry.attributes.opacity,{offset:0,count:e})});let G=[null!==(m=O.image.width)&&void 0!==m?m:1,null!==(y=O.image.height)&&void 0!==y?y:1],L=Math.max(G[0],G[1]);return G=[G[0]/L,G[1]/L],s.createElement("group",(0,n.Z)({ref:u},d),s.createElement(E.Provider,{value:R},e,s.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:F,args:[null,null,l],frustumCulled:c},s.createElement("instancedBufferAttribute",{usage:a.DynamicDrawUsage,attach:"instanceColor",args:[D,3]}),s.createElement("planeGeometry",{args:[...G]},s.createElement("instancedBufferAttribute",{usage:a.DynamicDrawUsage,attach:"attributes-opacity",args:[b,1]})),s.createElement("cloudMaterial",{key:t.name,map:O,transparent:!0,depthWrite:!1}))))}),T=s.forwardRef(({opacity:e=1,speed:t=0,bounds:r=[5,1,1],segments:i=20,color:l="#ffffff",fade:h=10,volume:c=6,smallestVolume:d=.25,distribute:u=null,growth:A=4,concentrate:p="inside",seed:f=Math.random(),...B},g)=>{function C(){let e=1e4*Math.sin(f++);return e-Math.floor(e)}let _=s.useContext(E),v=s.useRef(null),[y]=s.useState(()=>m()),T=s.useMemo(()=>[...Array(i)].map((e,t)=>({segments:i,bounds:new a.Vector3(1,1,1),position:new a.Vector3,uuid:y,index:t,ref:v,dist:0,matrix:new a.Matrix4,color:new a.Color,rotation:Math.PI/i*t})),[i,y]);return s.useLayoutEffect(()=>{T.forEach((n,s)=>{var a;(0,o.j)(n,{volume:c,color:l,speed:t,growth:A,opacity:e,fade:h,bounds:r,density:Math.max(.5,C()),rotationFactor:Math.max(.2,.5*C())*t});let m=null==u?void 0:u(n,s);(m||i>1)&&n.position.copy(n.bounds).multiply(null!==(a=null==m?void 0:m.point)&&void 0!==a?a:{x:2*C()-1,y:2*C()-1,z:2*C()-1});let f=Math.abs(n.position.x),B=Math.abs(n.position.y),g=Math.abs(n.position.z),_=Math.max(f,B,g);n.length=1,f===_&&(n.length-=f/n.bounds.x),B===_&&(n.length-=B/n.bounds.y),g===_&&(n.length-=g/n.bounds.z),n.volume=((null==m?void 0:m.volume)!==void 0?m.volume:Math.max(Math.max(0,d),"random"===p?C():"inside"===p?n.length:1-n.length))*c})},[p,r,h,l,e,A,c,f,i,t]),s.useLayoutEffect(()=>(_.current=[..._.current,...T],()=>{_.current=_.current.filter(e=>e.uuid!==y)}),[T]),s.useImperativeHandle(g,()=>v.current,[]),s.createElement("group",(0,n.Z)({ref:v},B))}),M=s.forwardRef((e,t)=>s.useContext(E)?s.createElement(T,(0,n.Z)({ref:t},e)):s.createElement(y,null,s.createElement(T,(0,n.Z)({ref:t},e))))},4307:function(e,t,r){"use strict";r.d(t,{j:function(){return h}});var i=r(2988),n=r(2265),s=r(7776),a=r(9473);let o={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},l={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `},h=n.forwardRef(({scale:e=10,frames:t=1/0,opacity:r=1,width:h=1,height:c=1,blur:d=1,near:u=0,far:m=10,resolution:A=512,smooth:p=!0,color:f="#000000",depthWrite:B=!1,renderOrder:g,...C},_)=>{let v,E;let y=n.useRef(null),T=(0,a.A)(e=>e.scene),M=(0,a.A)(e=>e.gl),F=n.useRef(null);h*=Array.isArray(e)?e[0]:e||1,c*=Array.isArray(e)?e[1]:e||1;let[R,b,D,O,x,I,w]=n.useMemo(()=>{let e=new s.WebGLRenderTarget(A,A),t=new s.WebGLRenderTarget(A,A);t.texture.generateMipmaps=e.texture.generateMipmaps=!1;let r=new s.PlaneGeometry(h,c).rotateX(Math.PI/2),i=new s.Mesh(r),n=new s.MeshDepthMaterial;n.depthTest=n.depthWrite=!1,n.onBeforeCompile=e=>{e.uniforms={...e.uniforms,ucolor:{value:new s.Color(f)}},e.fragmentShader=e.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),e.fragmentShader=e.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};let a=new s.ShaderMaterial(o),d=new s.ShaderMaterial(l);return d.depthTest=a.depthTest=!1,[e,r,n,i,a,d,t]},[A,h,c,e,f]),U=e=>{O.visible=!0,O.material=x,x.uniforms.tDiffuse.value=R.texture,x.uniforms.h.value=1*e/256,M.setRenderTarget(w),M.render(O,F.current),O.material=I,I.uniforms.tDiffuse.value=w.texture,I.uniforms.v.value=1*e/256,M.setRenderTarget(R),M.render(O,F.current),O.visible=!1},H=0;return(0,a.C)(()=>{F.current&&(t===1/0||H<t)&&(H++,v=T.background,E=T.overrideMaterial,y.current.visible=!1,T.background=null,T.overrideMaterial=D,M.setRenderTarget(R),M.render(T,F.current),U(d),p&&U(.4*d),M.setRenderTarget(null),y.current.visible=!0,T.overrideMaterial=E,T.background=v)}),n.useImperativeHandle(_,()=>y.current,[]),n.createElement("group",(0,i.Z)({"rotation-x":Math.PI/2},C,{ref:y}),n.createElement("mesh",{renderOrder:g,geometry:b,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},n.createElement("meshBasicMaterial",{transparent:!0,map:R.texture,opacity:r,depthWrite:B})),n.createElement("orthographicCamera",{ref:F,args:[-h/2,h/2,c/2,-c/2,u,m]}))})},3369:function(e,t,r){"use strict";let i;r.d(t,{qA:function(){return eR}});var n=r(2988),s=r(2265),a=r(9473),o=r(7776);let l=e=>e&&e.isCubeTexture;class h extends o.Mesh{constructor(e,t){var r,i;let n=l(e),s=Math.floor(Math.log2((null!=(i=n?null==(r=e.image[0])?void 0:r.width:e.image.width)?i:1024)/4)),a=Math.pow(2,s),h=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,c=[n?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/(3*Math.max(a,112))}`,`#define CUBEUV_TEXEL_HEIGHT ${1/(4*a)}`,`#define CUBEUV_MAX_MIP ${s}.0`].join("\n")+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(o.REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `;super(new o.IcosahedronGeometry(1,16),new o.ShaderMaterial({uniforms:{map:{value:e},height:{value:(null==t?void 0:t.height)||15},radius:{value:(null==t?void 0:t.radius)||100}},fragmentShader:c,vertexShader:h,side:o.DoubleSide}))}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}class c extends o.DataTextureLoader{constructor(e){super(e),this.type=o.HalfFloatType}parse(e){let t,r,i;let n=function(e,t){switch(e){case 1:throw Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw Error("THREE.RGBELoader: Memory Error: "+(t||""))}},s=function(e,t,r){t=t||1024;let i=e.pos,n=-1,s=0,a="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));for(;0>(n=o.indexOf("\n"))&&s<t&&i<e.byteLength;)a+=o,s+=o.length,i+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));return -1<n&&(!1!==r&&(e.pos+=s+n+1),a+o.slice(0,n))},a=new Uint8Array(e);a.pos=0;let l=function(e){let t,r;let i=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,h={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};for(!(e.pos>=e.byteLength)&&(t=s(e))||n(1,"no header found"),(r=t.match(/^#\?(\S+)/))||n(3,"bad initial token"),h.valid|=1,h.programtype=r[1],h.string+=t+"\n";!1!==(t=s(e));){if(h.string+=t+"\n","#"===t.charAt(0)){h.comments+=t+"\n";continue}if((r=t.match(i))&&(h.gamma=parseFloat(r[1])),(r=t.match(a))&&(h.exposure=parseFloat(r[1])),(r=t.match(o))&&(h.valid|=2,h.format=r[1]),(r=t.match(l))&&(h.valid|=4,h.height=parseInt(r[1],10),h.width=parseInt(r[2],10)),2&h.valid&&4&h.valid)break}return 2&h.valid||n(3,"missing format specifier"),4&h.valid||n(3,"missing image size specifier"),h}(a),h=l.width,c=l.height,d=function(e,t,r){if(t<8||t>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);t!==(e[2]<<8|e[3])&&n(3,"wrong scanline width");let i=new Uint8Array(4*t*r);i.length||n(4,"unable to allocate buffer space");let s=0,a=0,o=4*t,l=new Uint8Array(4),h=new Uint8Array(o),c=r;for(;c>0&&a<e.byteLength;){a+4>e.byteLength&&n(1),l[0]=e[a++],l[1]=e[a++],l[2]=e[a++],l[3]=e[a++],(2!=l[0]||2!=l[1]||(l[2]<<8|l[3])!=t)&&n(3,"bad rgbe scanline format");let r=0,d;for(;r<o&&a<e.byteLength;){let t=(d=e[a++])>128;if(t&&(d-=128),(0===d||r+d>o)&&n(3,"bad scanline data"),t){let t=e[a++];for(let e=0;e<d;e++)h[r++]=t}else h.set(e.subarray(a,a+d),r),r+=d,a+=d}for(let e=0;e<t;e++){let r=0;i[s]=h[e+r],r+=t,i[s+1]=h[e+r],r+=t,i[s+2]=h[e+r],r+=t,i[s+3]=h[e+r],s+=4}c--}return i}(a.subarray(a.pos),h,c);switch(this.type){case o.FloatType:let u=new Float32Array(4*(i=d.length/4));for(let e=0;e<i;e++)!function(e,t,r,i){let n=Math.pow(2,e[t+3]-128)/255;r[i+0]=e[t+0]*n,r[i+1]=e[t+1]*n,r[i+2]=e[t+2]*n,r[i+3]=1}(d,4*e,u,4*e);t=u,r=o.FloatType;break;case o.HalfFloatType:let m=new Uint16Array(4*(i=d.length/4));for(let e=0;e<i;e++)!function(e,t,r,i){let n=Math.pow(2,e[t+3]-128)/255;r[i+0]=o.DataUtils.toHalfFloat(Math.min(e[t+0]*n,65504)),r[i+1]=o.DataUtils.toHalfFloat(Math.min(e[t+1]*n,65504)),r[i+2]=o.DataUtils.toHalfFloat(Math.min(e[t+2]*n,65504)),r[i+3]=o.DataUtils.toHalfFloat(1)}(d,4*e,m,4*e);t=m,r=o.HalfFloatType;break;default:throw Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:h,height:c,data:t,header:l.string,gamma:l.gamma,exposure:l.exposure,type:r}}setDataType(e){return this.type=e,this}load(e,t,r,i){return super.load(e,function(e,r){switch(e.type){case o.FloatType:case o.HalfFloatType:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=o.LinearFilter,e.magFilter=o.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)},r,i)}}var d={},u=Uint8Array,m=Uint16Array,A=Uint32Array,p=new u([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f=new u([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),B=new u([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),g=function(e,t){for(var r=new m(31),i=0;i<31;++i)r[i]=t+=1<<e[i-1];for(var n=new A(r[30]),i=1;i<30;++i)for(var s=r[i];s<r[i+1];++s)n[s]=s-r[i]<<5|i;return[r,n]},C=g(p,2),_=C[0],v=C[1];_[28]=258,v[258]=28;for(var E=g(f,0),y=E[0],T=E[1],M=new m(32768),F=0;F<32768;++F){var R=(43690&F)>>>1|(21845&F)<<1;R=(61680&(R=(52428&R)>>>2|(13107&R)<<2))>>>4|(3855&R)<<4,M[F]=((65280&R)>>>8|(255&R)<<8)>>>1}for(var b=function(e,t,r){for(var i,n=e.length,s=0,a=new m(t);s<n;++s)++a[e[s]-1];var o=new m(t);for(s=0;s<t;++s)o[s]=o[s-1]+a[s-1]<<1;if(r){i=new m(1<<t);var l=15-t;for(s=0;s<n;++s)if(e[s])for(var h=s<<4|e[s],c=t-e[s],d=o[e[s]-1]++<<c,u=d|(1<<c)-1;d<=u;++d)i[M[d]>>>l]=h}else for(s=0,i=new m(n);s<n;++s)e[s]&&(i[s]=M[o[e[s]-1]++]>>>15-e[s]);return i},D=new u(288),F=0;F<144;++F)D[F]=8;for(var F=144;F<256;++F)D[F]=9;for(var F=256;F<280;++F)D[F]=7;for(var F=280;F<288;++F)D[F]=8;for(var O=new u(32),F=0;F<32;++F)O[F]=5;var x=b(D,9,1),I=b(O,5,1),w=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},U=function(e,t,r){var i=t/8|0;return(e[i]|e[i+1]<<8)>>(7&t)&r},H=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},G=function(e){return(e/8|0)+(7&e&&1)},L=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var i=new(e instanceof m?m:e instanceof A?A:u)(r-t);return i.set(e.subarray(t,r)),i},S=function(e,t,r){var i=e.length;if(!i||r&&!r.l&&i<5)return t||new u(0);var n=!t||r,s=!r||r.i;r||(r={}),t||(t=new u(3*i));var a=function(e){var r=t.length;if(e>r){var i=new u(Math.max(2*r,e));i.set(t),t=i}},o=r.f||0,l=r.p||0,h=r.b||0,c=r.l,d=r.d,m=r.m,A=r.n,g=8*i;do{if(!c){r.f=o=U(e,l,1);var C=U(e,l+1,3);if(l+=3,C){if(1==C)c=x,d=I,m=9,A=5;else if(2==C){var v=U(e,l,31)+257,E=U(e,l+10,15)+4,T=v+U(e,l+5,31)+1;l+=14;for(var M=new u(T),F=new u(19),R=0;R<E;++R)F[B[R]]=U(e,l+3*R,7);l+=3*E;for(var D=w(F),O=(1<<D)-1,S=b(F,D,1),R=0;R<T;){var P=S[U(e,l,O)];l+=15&P;var J=P>>>4;if(J<16)M[R++]=J;else{var N=0,k=0;for(16==J?(k=3+U(e,l,3),l+=2,N=M[R-1]):17==J?(k=3+U(e,l,7),l+=3):18==J&&(k=11+U(e,l,127),l+=7);k--;)M[R++]=N}}var K=M.subarray(0,v),Q=M.subarray(v);m=w(K),A=w(Q),c=b(K,m,1),d=b(Q,A,1)}else throw"invalid block type"}else{var J=G(l)+4,j=e[J-4]|e[J-3]<<8,Y=J+j;if(Y>i){if(s)throw"unexpected EOF";break}n&&a(h+j),t.set(e.subarray(J,Y),h),r.b=h+=j,r.p=l=8*Y;continue}if(l>g){if(s)throw"unexpected EOF";break}}n&&a(h+131072);for(var X=(1<<m)-1,V=(1<<A)-1,z=l;;z=l){var N=c[H(e,l)&X],Z=N>>>4;if((l+=15&N)>g){if(s)throw"unexpected EOF";break}if(!N)throw"invalid length/literal";if(Z<256)t[h++]=Z;else if(256==Z){z=l,c=null;break}else{var W=Z-254;if(Z>264){var R=Z-257,q=p[R];W=U(e,l,(1<<q)-1)+_[R],l+=q}var $=d[H(e,l)&V],ee=$>>>4;if(!$)throw"invalid distance";l+=15&$;var Q=y[ee];if(ee>3){var q=f[ee];Q+=H(e,l)&(1<<q)-1,l+=q}if(l>g){if(s)throw"unexpected EOF";break}n&&a(h+131072);for(var et=h+W;h<et;h+=4)t[h]=t[h-Q],t[h+1]=t[h+1-Q],t[h+2]=t[h+2-Q],t[h+3]=t[h+3-Q];h=et}}r.l=c,r.p=z,r.b=h,c&&(o=1,r.m=m,r.d=d,r.n=A)}while(!o);return h==t.length?t:L(t,0,h)},P=function(e,t,r){r<<=7&t;var i=t/8|0;e[i]|=r,e[i+1]|=r>>>8},J=function(e,t,r){r<<=7&t;var i=t/8|0;e[i]|=r,e[i+1]|=r>>>8,e[i+2]|=r>>>16},N=function(e,t){for(var r=[],i=0;i<e.length;++i)e[i]&&r.push({s:i,f:e[i]});var n=r.length,s=r.slice();if(!n)return[V,0];if(1==n){var a=new u(r[0].s+1);return a[r[0].s]=1,[a,1]}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],h=0,c=1,d=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};c!=n-1;)o=r[r[h].f<r[d].f?h++:d++],l=r[h!=c&&r[h].f<r[d].f?h++:d++],r[c++]={s:-1,f:o.f+l.f,l:o,r:l};for(var A=s[0].s,i=1;i<n;++i)s[i].s>A&&(A=s[i].s);var p=new m(A+1),f=k(r[c-1],p,0);if(f>t){var i=0,B=0,g=f-t,C=1<<g;for(s.sort(function(e,t){return p[t.s]-p[e.s]||e.f-t.f});i<n;++i){var _=s[i].s;if(p[_]>t)B+=C-(1<<f-p[_]),p[_]=t;else break}for(B>>>=g;B>0;){var v=s[i].s;p[v]<t?B-=1<<t-p[v]++-1:++i}for(;i>=0&&B;--i){var E=s[i].s;p[E]==t&&(--p[E],++B)}f=t}return[new u(p),f]},k=function(e,t,r){return -1==e.s?Math.max(k(e.l,t,r+1),k(e.r,t,r+1)):t[e.s]=r},K=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new m(++t),i=0,n=e[0],s=1,a=function(e){r[i++]=e},o=1;o<=t;++o)if(e[o]==n&&o!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=e[o]}return[r.subarray(0,i),t]},Q=function(e,t){for(var r=0,i=0;i<t.length;++i)r+=e[i]*t[i];return r},j=function(e,t,r){var i=r.length,n=G(t+2);e[n]=255&i,e[n+1]=i>>>8,e[n+2]=255^e[n],e[n+3]=255^e[n+1];for(var s=0;s<i;++s)e[n+s+4]=r[s];return(n+4+i)*8},Y=function(e,t,r,i,n,s,a,o,l,h,c){P(t,c++,r),++n[256];for(var d,u,A,g,C=N(n,15),_=C[0],v=C[1],E=N(s,15),y=E[0],T=E[1],M=K(_),F=M[0],R=M[1],x=K(y),I=x[0],w=x[1],U=new m(19),H=0;H<F.length;++H)U[31&F[H]]++;for(var H=0;H<I.length;++H)U[31&I[H]]++;for(var G=N(U,7),L=G[0],S=G[1],k=19;k>4&&!L[B[k-1]];--k);var Y=h+5<<3,X=Q(n,D)+Q(s,O)+a,V=Q(n,_)+Q(s,y)+a+14+3*k+Q(U,L)+(2*U[16]+3*U[17]+7*U[18]);if(Y<=X&&Y<=V)return j(t,c,e.subarray(l,l+h));if(P(t,c,1+(V<X)),c+=2,V<X){d=b(_,v,0),u=_,A=b(y,T,0),g=y;var z=b(L,S,0);P(t,c,R-257),P(t,c+5,w-1),P(t,c+10,k-4),c+=14;for(var H=0;H<k;++H)P(t,c+3*H,L[B[H]]);c+=3*k;for(var Z=[F,I],W=0;W<2;++W)for(var q=Z[W],H=0;H<q.length;++H){var $=31&q[H];P(t,c,z[$]),c+=L[$],$>15&&(P(t,c,q[H]>>>5&127),c+=q[H]>>>12)}}else d=null,u=D,A=null,g=O;for(var H=0;H<o;++H)if(i[H]>255){var $=i[H]>>>18&31;J(t,c,d[$+257]),c+=u[$+257],$>7&&(P(t,c,i[H]>>>23&31),c+=p[$]);var ee=31&i[H];J(t,c,A[ee]),c+=g[ee],ee>3&&(J(t,c,i[H]>>>5&8191),c+=f[ee])}else J(t,c,d[i[H]]),c+=u[i[H]];return J(t,c,d[256]),c+u[256]},X=new A([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),V=new u(0),z=function(e){if((15&e[0])!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function Z(e,t){return S((z(e),e.subarray(2,-4)),t)}var W="undefined"!=typeof TextDecoder&&new TextDecoder;try{W.decode(V,{stream:!0})}catch(e){}let q="colorSpace"in new o.Texture;class $ extends o.DataTextureLoader{constructor(e){super(e),this.type=o.HalfFloatType}parse(e){let t={l:0,c:0,lc:0};function r(e,r,i,n,s){for(;i<e;)r=r<<8|F(n,s),i+=8;i-=e,t.l=r>>i&(1<<e)-1,t.c=r,t.lc=i}let i=Array(59),n={c:0,lc:0};function s(e,t,r,i){e=e<<8|F(r,i),t+=8,n.c=e,n.lc=t}let a={c:0,lc:0};function l(e,t,r,i,o,l,h,c,d,u){if(e==t){i<8&&(s(r,i,o,h),r=n.c,i=n.lc);var m=r>>(i-=8),m=new Uint8Array([m])[0];if(d.value+m>u)return!1;for(var A=c[d.value-1];m-- >0;)c[d.value++]=A}else{if(!(d.value<u))return!1;c[d.value++]=e}a.c=r,a.lc=i}function h(e){var t=65535&e;return t>32767?t-65536:t}let c={a:0,b:0};function d(e,t){var r=h(e),i=h(t),n=r+(1&i)+(i>>1),s=n-i;c.a=n,c.b=s}function u(e,t){var r=65535&t,i=(65535&e)-(r>>1)&65535;c.a=r+i-32768&65535,c.b=i}function m(e,o,h,c,d,u){var m=h.value,A=M(o,h),p=M(o,h);h.value+=4;var f=M(o,h);if(h.value+=4,A<0||A>=65537||p<0||p>=65537)throw"Something wrong with HUF_ENCSIZE";var B=Array(65537),g=Array(16384);!function(e){for(var t=0;t<16384;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(g);var C=c-(h.value-m);if(!function(e,n,s,a,o,l,h){for(var c=0,d=0;o<=l;o++){if(s.value-s.value>a)return!1;r(6,c,d,e,s);var u=t.l;if(c=t.c,d=t.lc,h[o]=u,63==u){if(s.value-s.value>a)throw"Something wrong with hufUnpackEncTable";r(8,c,d,e,s);var m=t.l+6;if(c=t.c,d=t.lc,o+m>l+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)h[o++]=0;o--}else if(u>=59){var m=u-59+2;if(o+m>l+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)h[o++]=0;o--}}!function(e){for(var t=0;t<=58;++t)i[t]=0;for(var t=0;t<65537;++t)i[e[t]]+=1;for(var r=0,t=58;t>0;--t){var n=r+i[t]>>1;i[t]=r,r=n}for(var t=0;t<65537;++t){var s=e[t];s>0&&(e[t]=s|i[s]++<<6)}}(h)}(e,0,h,C,A,p,B),f>8*(c-(h.value-m)))throw"Something wrong with hufUncompress";!function(e,t,r,i){for(;t<=r;t++){var n=e[t]>>6,s=63&e[t];if(n>>s)throw"Invalid table entry";if(s>14){var a=i[n>>s-14];if(a.len)throw"Invalid table entry";if(a.lit++,a.p){var o=a.p;a.p=Array(a.lit);for(var l=0;l<a.lit-1;++l)a.p[l]=o[l]}else a.p=[,];a.p[a.lit-1]=t}else if(s)for(var h=0,l=1<<14-s;l>0;l--){var a=i[(n<<14-s)+h];if(a.len||a.p)throw"Invalid table entry";a.len=s,a.lit=t,h++}}}(B,A,p,g),function(e,t,r,i,o,h,c,d,u,m){for(var A=0,p=0,f=Math.trunc(o.value+(h+7)/8);o.value<f;)for(s(A,p,r,o),A=n.c,p=n.lc;p>=14;){var B=t[A>>p-14&16383];if(B.len)p-=B.len,l(B.lit,c,A,p,r,i,o,u,m,d),A=a.c,p=a.lc;else{if(!B.p)throw"hufDecode issues";for(g=0;g<B.lit;g++){for(var g,C=63&e[B.p[g]];p<C&&o.value<f;)s(A,p,r,o),A=n.c,p=n.lc;if(p>=C&&e[B.p[g]]>>6==(A>>p-C&(1<<C)-1)){p-=C,l(B.p[g],c,A,p,r,i,o,u,m,d),A=a.c,p=a.lc;break}}if(g==B.lit)throw"hufDecode issues"}}var _=8-h&7;for(A>>=_,p-=_;p>0;){var B=t[A<<14-p&16383];if(B.len)p-=B.len,l(B.lit,c,A,p,r,i,o,u,m,d),A=a.c,p=a.lc;else throw"hufDecode issues"}}(B,g,e,o,h,f,p,u,d,{value:0})}function A(e){for(var t=1;t<e.length;t++){var r=e[t-1]+e[t]-128;e[t]=r}}function p(e,t){for(var r=0,i=Math.floor((e.length+1)/2),n=0,s=e.length-1;!(n>s)&&(t[n++]=e[r++],!(n>s));)t[n++]=e[i++]}function f(e){for(var t=e.byteLength,r=[],i=0,n=new DataView(e);t>0;){var s=n.getInt8(i++);if(s<0){var a=-s;t-=a+1;for(var o=0;o<a;o++)r.push(n.getUint8(i++))}else{var a=s;t-=2;for(var l=n.getUint8(i++),o=0;o<a+1;o++)r.push(l)}}return r}function B(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function g(e){var t=new Uint8Array(f(e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size))),r=new Uint8Array(t.length);return A(t),p(t,r),new DataView(r.buffer)}function C(e){var t=Z(e.array.slice(e.offset.value,e.offset.value+e.size)),r=new Uint8Array(t.length);return A(t),p(t,r),new DataView(r.buffer)}function _(e){for(var t=e.viewer,r={value:e.offset.value},i=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),n=new Uint8Array(8192),s=0,a=Array(e.channels),o=0;o<e.channels;o++)a[o]={},a[o].start=s,a[o].end=a[o].start,a[o].nx=e.width,a[o].ny=e.lines,a[o].size=e.type,s+=a[o].nx*a[o].ny*a[o].size;var l=I(t,r),h=I(t,r);if(h>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(l<=h)for(var o=0;o<h-l+1;o++)n[o+l]=R(t,r);var A=new Uint16Array(65536),p=function(e,t){for(var r=0,i=0;i<65536;++i)(0==i||e[i>>3]&1<<(7&i))&&(t[r++]=i);for(var n=r-1;r<65536;)t[r++]=0;return n}(n,A),f=M(t,r);m(e.array,t,r,f,i,s);for(var o=0;o<e.channels;++o)for(var B=a[o],g=0;g<a[o].size;++g)!function(e,t,r,i,n,s,a){for(var o=a<16384,l=r>n?n:r,h=1;h<=l;)h<<=1;for(h>>=1,m=h,h>>=1;h>=1;){for(var m,A,p,f,B,g=0,C=0+s*(n-m),_=s*h,v=s*m,E=i*h,y=i*m;g<=C;g+=v){for(var T=g,M=g+i*(r-m);T<=M;T+=y){var F=T+E,R=T+_,b=R+E;o?(d(e[T+t],e[R+t]),A=c.a,f=c.b,d(e[F+t],e[b+t]),p=c.a,B=c.b,d(A,p),e[T+t]=c.a,e[F+t]=c.b,d(f,B)):(u(e[T+t],e[R+t]),A=c.a,f=c.b,u(e[F+t],e[b+t]),p=c.a,B=c.b,u(A,p),e[T+t]=c.a,e[F+t]=c.b,u(f,B)),e[R+t]=c.a,e[b+t]=c.b}if(r&h){var R=T+_;o?d(e[T+t],e[R+t]):u(e[T+t],e[R+t]),A=c.a,e[R+t]=c.b,e[T+t]=A}}if(n&h)for(var T=g,M=g+i*(r-m);T<=M;T+=y){var F=T+E;o?d(e[T+t],e[F+t]):u(e[T+t],e[F+t]),A=c.a,e[F+t]=c.b,e[T+t]=A}m=h,h>>=1}}(i,B.start+g,B.nx,B.size,B.ny,B.nx*B.size,p);!function(e,t,r){for(var i=0;i<r;++i)t[i]=e[t[i]]}(A,i,s);for(var C=0,_=new Uint8Array(i.buffer.byteLength),v=0;v<e.lines;v++)for(var E=0;E<e.channels;E++){var B=a[E],y=B.nx*B.size,T=new Uint8Array(i.buffer,2*B.end,2*y);_.set(T,C),C+=2*y,B.end+=y}return new DataView(_.buffer)}function v(e){var t=Z(e.array.slice(e.offset.value,e.offset.value+e.size));let r=e.lines*e.channels*e.width,i=1==e.type?new Uint16Array(r):new Uint32Array(r),n=0,s=0,a=[,,,,];for(let r=0;r<e.lines;r++)for(let r=0;r<e.channels;r++){let r=0;switch(e.type){case 1:a[0]=n,a[1]=a[0]+e.width,n=a[1]+e.width;for(let n=0;n<e.width;++n)r+=t[a[0]++]<<8|t[a[1]++],i[s]=r,s++;break;case 2:a[0]=n,a[1]=a[0]+e.width,a[2]=a[1]+e.width,n=a[2]+e.width;for(let n=0;n<e.width;++n)r+=t[a[0]++]<<24|t[a[1]++]<<16|t[a[2]++]<<8,i[s]=r,s++}}return new DataView(i.buffer)}function E(e){var t=e.viewer,r={value:e.offset.value},i=new Uint8Array(e.width*e.lines*(e.channels*e.type*2)),n={version:b(t,r),unknownUncompressedSize:b(t,r),unknownCompressedSize:b(t,r),acCompressedSize:b(t,r),dcCompressedSize:b(t,r),rleCompressedSize:b(t,r),rleUncompressedSize:b(t,r),rleRawSize:b(t,r),totalAcUncompressedCount:b(t,r),totalDcUncompressedCount:b(t,r),acCompression:b(t,r)};if(n.version<2)throw"EXRLoader.parse: "+L.compression+" version "+n.version+" is unsupported";for(var s=[],a=I(t,r)-2;a>0;){var l=y(t.buffer,r),h=R(t,r),c=h>>2&3,d=new Int8Array([(h>>4)-1])[0],u=R(t,r);s.push({name:l,index:d,type:u,compression:c}),a-=l.length+3}for(var A=L.channels,p=Array(e.channels),B=0;B<e.channels;++B){var g=p[B]={},_=A[B];g.name=_.name,g.compression=0,g.decoded=!1,g.type=_.pixelType,g.pLinear=_.pLinear,g.width=e.width,g.height=e.lines}for(var v={idx:[,,,]},E=0;E<e.channels;++E)for(var g=p[E],B=0;B<s.length;++B){var T=s[B];g.name==T.name&&(g.compression=T.compression,T.index>=0&&(v.idx[T.index]=E),g.offset=E)}if(n.acCompressedSize>0)switch(n.acCompression){case 0:var M=new Uint16Array(n.totalAcUncompressedCount);m(e.array,t,r,n.acCompressedSize,M,n.totalAcUncompressedCount);break;case 1:var F=e.array.slice(r.value,r.value+n.totalAcUncompressedCount),D=Z(F),M=new Uint16Array(D.buffer);r.value+=n.totalAcUncompressedCount}if(n.dcCompressedSize>0){var O=new Uint16Array(C({array:e.array,offset:r,size:n.dcCompressedSize}).buffer);r.value+=n.dcCompressedSize}if(n.rleRawSize>0){var F=e.array.slice(r.value,r.value+n.rleCompressedSize),D=Z(F),w=f(D.buffer);r.value+=n.rleCompressedSize}for(var U=0,H=Array(p.length),B=0;B<H.length;++B)H[B]=[];for(var G=0;G<e.lines;++G)for(var S=0;S<p.length;++S)H[S].push(U),U+=p[S].width*e.type*2;!function(e,t,r,i,n,s){var a=new DataView(s.buffer),l=r[e.idx[0]].width,h=r[e.idx[0]].height,c=Math.floor(l/8),d=Math.ceil(l/8),u=Math.ceil(h/8),m=l-(d-1)*8,A=h-(u-1)*8,p={value:0},f=[,,,],B=[,,,],g=[,,,],C=[,,,],_=[,,,];for(let r=0;r<3;++r)_[r]=t[e.idx[r]],f[r]=r<1?0:f[r-1]+d*u,B[r]=new Float32Array(64),g[r]=new Uint16Array(64),C[r]=new Uint16Array(64*d);for(let t=0;t<u;++t){var v,E,y=8;t==u-1&&(y=A);var T=8;for(let e=0;e<d;++e){e==d-1&&(T=m);for(let e=0;e<3;++e)g[e].fill(0),g[e][0]=n[f[e]++],function(e,t,r){for(var i,n=1;n<64;)65280==(i=t[e.value])?n=64:i>>8==255?n+=255&i:(r[n]=i,n++),e.value++}(p,i,g[e]),v=g[e],(E=B[e])[0]=x(v[0]),E[1]=x(v[1]),E[2]=x(v[5]),E[3]=x(v[6]),E[4]=x(v[14]),E[5]=x(v[15]),E[6]=x(v[27]),E[7]=x(v[28]),E[8]=x(v[2]),E[9]=x(v[4]),E[10]=x(v[7]),E[11]=x(v[13]),E[12]=x(v[16]),E[13]=x(v[26]),E[14]=x(v[29]),E[15]=x(v[42]),E[16]=x(v[3]),E[17]=x(v[8]),E[18]=x(v[12]),E[19]=x(v[17]),E[20]=x(v[25]),E[21]=x(v[30]),E[22]=x(v[41]),E[23]=x(v[43]),E[24]=x(v[9]),E[25]=x(v[11]),E[26]=x(v[18]),E[27]=x(v[24]),E[28]=x(v[31]),E[29]=x(v[40]),E[30]=x(v[44]),E[31]=x(v[53]),E[32]=x(v[10]),E[33]=x(v[19]),E[34]=x(v[23]),E[35]=x(v[32]),E[36]=x(v[39]),E[37]=x(v[45]),E[38]=x(v[52]),E[39]=x(v[54]),E[40]=x(v[20]),E[41]=x(v[22]),E[42]=x(v[33]),E[43]=x(v[38]),E[44]=x(v[46]),E[45]=x(v[51]),E[46]=x(v[55]),E[47]=x(v[60]),E[48]=x(v[21]),E[49]=x(v[34]),E[50]=x(v[37]),E[51]=x(v[47]),E[52]=x(v[50]),E[53]=x(v[56]),E[54]=x(v[59]),E[55]=x(v[61]),E[56]=x(v[35]),E[57]=x(v[36]),E[58]=x(v[48]),E[59]=x(v[49]),E[60]=x(v[57]),E[61]=x(v[58]),E[62]=x(v[62]),E[63]=x(v[63]),function(e){let t=.5*Math.cos(3.14159/16),r=.5*Math.cos(3.14159/8),i=.5*Math.cos(3*3.14159/16),n=.5*Math.cos(3*3.14159/8);for(var s=[,,,,],a=[,,,,],o=[,,,,],l=[,,,,],h=0;h<8;++h){var c=8*h;s[0]=r*e[c+2],s[1]=n*e[c+2],s[2]=r*e[c+6],s[3]=n*e[c+6],a[0]=t*e[c+1]+i*e[c+3]+.2777854612564676*e[c+5]+.09754573032714427*e[c+7],a[1]=i*e[c+1]-.09754573032714427*e[c+3]-t*e[c+5]-.2777854612564676*e[c+7],a[2]=.2777854612564676*e[c+1]-t*e[c+3]+.09754573032714427*e[c+5]+i*e[c+7],a[3]=.09754573032714427*e[c+1]-.2777854612564676*e[c+3]+i*e[c+5]-t*e[c+7],o[0]=.35355362513961314*(e[c+0]+e[c+4]),o[3]=.35355362513961314*(e[c+0]-e[c+4]),o[1]=s[0]+s[3],o[2]=s[1]-s[2],l[0]=o[0]+o[1],l[1]=o[3]+o[2],l[2]=o[3]-o[2],l[3]=o[0]-o[1],e[c+0]=l[0]+a[0],e[c+1]=l[1]+a[1],e[c+2]=l[2]+a[2],e[c+3]=l[3]+a[3],e[c+4]=l[3]-a[3],e[c+5]=l[2]-a[2],e[c+6]=l[1]-a[1],e[c+7]=l[0]-a[0]}for(var d=0;d<8;++d)s[0]=r*e[16+d],s[1]=n*e[16+d],s[2]=r*e[48+d],s[3]=n*e[48+d],a[0]=t*e[8+d]+i*e[24+d]+.2777854612564676*e[40+d]+.09754573032714427*e[56+d],a[1]=i*e[8+d]-.09754573032714427*e[24+d]-t*e[40+d]-.2777854612564676*e[56+d],a[2]=.2777854612564676*e[8+d]-t*e[24+d]+.09754573032714427*e[40+d]+i*e[56+d],a[3]=.09754573032714427*e[8+d]-.2777854612564676*e[24+d]+i*e[40+d]-t*e[56+d],o[0]=.35355362513961314*(e[d]+e[32+d]),o[3]=.35355362513961314*(e[d]-e[32+d]),o[1]=s[0]+s[3],o[2]=s[1]-s[2],l[0]=o[0]+o[1],l[1]=o[3]+o[2],l[2]=o[3]-o[2],l[3]=o[0]-o[1],e[0+d]=l[0]+a[0],e[8+d]=l[1]+a[1],e[16+d]=l[2]+a[2],e[24+d]=l[3]+a[3],e[32+d]=l[3]-a[3],e[40+d]=l[2]-a[2],e[48+d]=l[1]-a[1],e[56+d]=l[0]-a[0]}(B[e]);!function(e){for(var t=0;t<64;++t){var r=e[0][t],i=e[1][t],n=e[2][t];e[0][t]=r+1.5747*n,e[1][t]=r-.1873*i-.4682*n,e[2][t]=r+1.8556*i}}(B);for(let t=0;t<3;++t)!function(e,t,r){for(var i,n=0;n<64;++n)t[r+n]=o.DataUtils.toHalfFloat((i=e[n])<=1?Math.sign(i)*Math.pow(Math.abs(i),2.2):Math.sign(i)*Math.pow(9.025013291561939,Math.abs(i)-1))}(B[t],C[t],64*e)}let s=0;for(let i=0;i<3;++i){let n=r[e.idx[i]].type;for(let e=8*t;e<8*t+y;++e){s=_[i][e];for(let t=0;t<c;++t){let r=64*t+(7&e)*8;a.setUint16(s+0*n,C[i][r+0],!0),a.setUint16(s+2*n,C[i][r+1],!0),a.setUint16(s+4*n,C[i][r+2],!0),a.setUint16(s+6*n,C[i][r+3],!0),a.setUint16(s+8*n,C[i][r+4],!0),a.setUint16(s+10*n,C[i][r+5],!0),a.setUint16(s+12*n,C[i][r+6],!0),a.setUint16(s+14*n,C[i][r+7],!0),s+=16*n}}if(c!=d)for(let e=8*t;e<8*t+y;++e){let t=_[i][e]+8*c*2*n,r=64*c+(7&e)*8;for(let e=0;e<T;++e)a.setUint16(t+2*e*n,C[i][r+e],!0)}}}for(var M=new Uint16Array(l),a=new DataView(s.buffer),F=0;F<3;++F){r[e.idx[F]].decoded=!0;var R=r[e.idx[F]].type;if(2==r[F].type)for(var b=0;b<h;++b){let e=_[F][b];for(var D=0;D<l;++D)M[D]=a.getUint16(e+2*D*R,!0);for(var D=0;D<l;++D)a.setFloat32(e+2*D*R,x(M[D]),!0)}}}(v,H,p,M,O,i);for(var B=0;B<p.length;++B){var g=p[B];if(!g.decoded){if(2===g.compression)for(var P=0,J=0,G=0;G<e.lines;++G){for(var N=H[B][P],k=0;k<g.width;++k){for(var K=0;K<2*g.type;++K)i[N++]=w[J+K*g.width*g.height];J++}P++}else throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(i.buffer)}function y(e,t){for(var r=new Uint8Array(e),i=0;0!=r[t.value+i];)i+=1;var n=new TextDecoder().decode(r.slice(t.value,t.value+i));return t.value=t.value+i+1,n}function T(e,t){var r=e.getInt32(t.value,!0);return t.value=t.value+4,r}function M(e,t){var r=e.getUint32(t.value,!0);return t.value=t.value+4,r}function F(e,t){var r=e[t.value];return t.value=t.value+1,r}function R(e,t){var r=e.getUint8(t.value);return t.value=t.value+1,r}let b=function(e,t){let r;return"getBigInt64"in DataView.prototype?r=Number(e.getBigInt64(t.value,!0)):r=e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,r};function D(e,t){var r=e.getFloat32(t.value,!0);return t.value+=4,r}function O(e,t){return o.DataUtils.toHalfFloat(D(e,t))}function x(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function I(e,t){var r=e.getUint16(t.value,!0);return t.value+=2,r}function w(e,t){return x(I(e,t))}let U=new DataView(e),H=new Uint8Array(e),G={value:0},L=function(e,t,r){let i={};if(20000630!=e.getUint32(0,!0))throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";i.version=e.getUint8(4);let n=e.getUint8(5);i.spec={singleTile:!!(2&n),longName:!!(4&n),deepFormat:!!(8&n),multiPart:!!(16&n)},r.value=8;for(var s=!0;s;){var a=y(t,r);if(0==a)s=!1;else{var o=y(t,r),l=M(e,r),h=function(e,t,r,i,n){var s,a,o,l,h;if("string"===i||"stringvector"===i||"iccProfile"===i)return s=new TextDecoder().decode(new Uint8Array(t).slice(r.value,r.value+n)),r.value=r.value+n,s;if("chlist"===i)return function(e,t,r,i){for(var n=r.value,s=[];r.value<n+i-1;){var a=y(t,r),o=T(e,r),l=R(e,r);r.value+=3;var h=T(e,r),c=T(e,r);s.push({name:a,pixelType:o,pLinear:l,xSampling:h,ySampling:c})}return r.value+=1,s}(e,t,r,n);if("chromaticities"===i)return a=D(e,r),o=D(e,r),l=D(e,r),h=D(e,r),{redX:a,redY:o,greenX:l,greenY:h,blueX:D(e,r),blueY:D(e,r),whiteX:D(e,r),whiteY:D(e,r)};if("compression"===i)return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][R(e,r)];if("box2i"===i)return{xMin:M(e,r),yMin:M(e,r),xMax:M(e,r),yMax:M(e,r)};if("lineOrder"===i)return["INCREASING_Y"][R(e,r)];if("float"===i)return D(e,r);else if("v2f"===i)return[D(e,r),D(e,r)];else if("v3f"===i)return[D(e,r),D(e,r),D(e,r)];else if("int"===i)return T(e,r);else if("rational"===i)return[T(e,r),M(e,r)];else if("timecode"===i)return[M(e,r),M(e,r)];else return"preview"===i?(r.value+=n,"skipped"):void(r.value+=n)}(e,t,r,o,l);void 0===h?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${o}'.`):i[a]=h}}if((-5&n)!=0)throw console.error("EXRHeader:",i),"THREE.EXRLoader: provided file is currently unsupported.";return i}(U,e,G),S=function(e,t,r,i,n){let s={size:0,viewer:t,array:r,offset:i,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:e.channels[0].pixelType,uncompress:null,getter:null,format:null,[q?"colorSpace":"encoding"]:null};switch(e.compression){case"NO_COMPRESSION":s.lines=1,s.uncompress=B;break;case"RLE_COMPRESSION":s.lines=1,s.uncompress=g;break;case"ZIPS_COMPRESSION":s.lines=1,s.uncompress=C;break;case"ZIP_COMPRESSION":s.lines=16,s.uncompress=C;break;case"PIZ_COMPRESSION":s.lines=32,s.uncompress=_;break;case"PXR24_COMPRESSION":s.lines=16,s.uncompress=v;break;case"DWAA_COMPRESSION":s.lines=32,s.uncompress=E;break;case"DWAB_COMPRESSION":s.lines=256,s.uncompress=E;break;default:throw"EXRLoader.parse: "+e.compression+" is unsupported"}if(s.scanlineBlockSize=s.lines,1==s.type)switch(n){case o.FloatType:s.getter=w,s.inputSize=2;break;case o.HalfFloatType:s.getter=I,s.inputSize=2}else if(2==s.type)switch(n){case o.FloatType:s.getter=D,s.inputSize=4;break;case o.HalfFloatType:s.getter=O,s.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+s.type+" for "+e.compression+".";s.blockCount=(e.dataWindow.yMax+1)/s.scanlineBlockSize;for(var a=0;a<s.blockCount;a++)b(t,i);s.outputChannels=3==s.channels?4:s.channels;let l=s.width*s.height*s.outputChannels;switch(n){case o.FloatType:s.byteArray=new Float32Array(l),s.channels<s.outputChannels&&s.byteArray.fill(1,0,l);break;case o.HalfFloatType:s.byteArray=new Uint16Array(l),s.channels<s.outputChannels&&s.byteArray.fill(15360,0,l);break;default:console.error("THREE.EXRLoader: unsupported type: ",n)}return s.bytesPerLine=s.width*s.inputSize*s.channels,4==s.outputChannels?s.format=o.RGBAFormat:s.format=o.RedFormat,q?s.colorSpace="srgb-linear":s.encoding=3e3,s}(L,U,H,G,this.type),P={value:0},J={R:0,G:1,B:2,A:3,Y:0};for(let e=0;e<S.height/S.scanlineBlockSize;e++){let t=M(U,G);S.size=M(U,G),S.lines=t+S.scanlineBlockSize>S.height?S.height-t:S.scanlineBlockSize;let r=S.size<S.lines*S.bytesPerLine?S.uncompress(S):B(S);G.value+=S.size;for(let t=0;t<S.scanlineBlockSize;t++){let i=t+e*S.scanlineBlockSize;if(i>=S.height)break;for(let e=0;e<S.channels;e++){let n=J[L.channels[e].name];for(let s=0;s<S.width;s++){P.value=(S.channels*S.width*t+e*S.width+s)*S.inputSize;let a=(S.height-1-i)*(S.width*S.outputChannels)+s*S.outputChannels+n;S.byteArray[a]=S.getter(r,P)}}}}return{header:L,width:S.width,height:S.height,data:S.byteArray,format:S.format,[q?"colorSpace":"encoding"]:S[q?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,i){return super.load(e,function(e,r){q?e.colorSpace=r.colorSpace:e.encoding=r.encoding,e.minFilter=o.LinearFilter,e.magFilter=o.LinearFilter,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,r)},r,i)}}let ee=(e,t,r)=>{let i;switch(e){case o.UnsignedByteType:i=new Uint8ClampedArray(t*r*4);break;case o.HalfFloatType:i=new Uint16Array(t*r*4);break;case o.UnsignedIntType:i=new Uint32Array(t*r*4);break;case o.ByteType:i=new Int8Array(t*r*4);break;case o.ShortType:i=new Int16Array(t*r*4);break;case o.IntType:i=new Int32Array(t*r*4);break;case o.FloatType:i=new Float32Array(t*r*4);break;default:throw Error("Unsupported data type")}return i},et=(e,t,r,n)=>{if(void 0!==i)return i;let s=new o.WebGLRenderTarget(1,1,n);t.setRenderTarget(s);let a=new o.Mesh(new o.PlaneGeometry,new o.MeshBasicMaterial({color:16777215}));t.render(a,r),t.setRenderTarget(null);let l=ee(e,s.width,s.height);return t.readRenderTargetPixels(s,0,0,s.width,s.height,l),s.dispose(),a.geometry.dispose(),a.material.dispose(),i=0!==l[0]};class er{constructor(e){var t,r,i,n,s,a,l,h,c,d,u,m,A,p,f,B;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;let g={format:o.RGBAFormat,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:(null===(t=e.renderTargetOptions)||void 0===t?void 0:t.anisotropy)!==void 0?null===(r=e.renderTargetOptions)||void 0===r?void 0:r.anisotropy:1,generateMipmaps:(null===(i=e.renderTargetOptions)||void 0===i?void 0:i.generateMipmaps)!==void 0&&(null===(n=e.renderTargetOptions)||void 0===n?void 0:n.generateMipmaps),magFilter:(null===(s=e.renderTargetOptions)||void 0===s?void 0:s.magFilter)!==void 0?null===(a=e.renderTargetOptions)||void 0===a?void 0:a.magFilter:o.LinearFilter,minFilter:(null===(l=e.renderTargetOptions)||void 0===l?void 0:l.minFilter)!==void 0?null===(h=e.renderTargetOptions)||void 0===h?void 0:h.minFilter:o.LinearFilter,samples:(null===(c=e.renderTargetOptions)||void 0===c?void 0:c.samples)!==void 0?null===(d=e.renderTargetOptions)||void 0===d?void 0:d.samples:void 0,wrapS:(null===(u=e.renderTargetOptions)||void 0===u?void 0:u.wrapS)!==void 0?null===(m=e.renderTargetOptions)||void 0===m?void 0:m.wrapS:o.ClampToEdgeWrapping,wrapT:(null===(A=e.renderTargetOptions)||void 0===A?void 0:A.wrapT)!==void 0?null===(p=e.renderTargetOptions)||void 0===p?void 0:p.wrapT:o.ClampToEdgeWrapping};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=er.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new o.Scene,this._camera=new o.OrthographicCamera,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!et(this._type,this._renderer,this._camera,g)){let e;this._type===o.HalfFloatType&&(e=this._renderer.extensions.has("EXT_color_buffer_float")?o.FloatType:void 0),void 0!==e?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${o.FloatType}`),this._type=e):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new o.Mesh(new o.PlaneGeometry,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new o.WebGLRenderTarget(this.width,this.height,g),this._renderTarget.texture.mapping=(null===(f=e.renderTargetOptions)||void 0===f?void 0:f.mapping)!==void 0?null===(B=e.renderTargetOptions)||void 0===B?void 0:B.mapping:o.UVMapping}static instantiateRenderer(){let e=new o.WebGLRenderer;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw Error("Can't read pixels in this browser");let e=ee(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){let t=new o.DataTexture(this.toArray(),this.width,this.height,o.RGBAFormat,this._type,(null==e?void 0:e.mapping)||o.UVMapping,(null==e?void 0:e.wrapS)||o.ClampToEdgeWrapping,(null==e?void 0:e.wrapT)||o.ClampToEdgeWrapping,(null==e?void 0:e.magFilter)||o.LinearFilter,(null==e?void 0:e.minFilter)||o.LinearFilter,(null==e?void 0:e.anisotropy)||1,o.LinearSRGBColorSpace);return t.generateMipmaps=(null==e?void 0:e.generateMipmaps)!==void 0&&(null==e?void 0:e.generateMipmaps),t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof o.ShaderMaterial&&Object.values(this.material.uniforms).forEach(e=>{e.value instanceof o.Texture&&e.value.dispose()}),Object.values(this.material).forEach(e=>{e instanceof o.Texture&&e.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}let ei=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,en=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class es extends o.ShaderMaterial{constructor({gamma:e,offsetHdr:t,offsetSdr:r,gainMapMin:i,gainMapMax:n,maxDisplayBoost:s,hdrCapacityMin:a,hdrCapacityMax:l,sdr:h,gainMap:c}){super({name:"GainMapDecoderMaterial",vertexShader:ei,fragmentShader:en,uniforms:{sdr:{value:h},gainMap:{value:c},gamma:{value:new o.Vector3(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new o.Vector3().fromArray(t)},offsetSdr:{value:new o.Vector3().fromArray(r)},gainMapMin:{value:new o.Vector3().fromArray(i)},gainMapMax:{value:new o.Vector3().fromArray(n)},weightFactor:{value:(Math.log2(s)-a)/(l-a)}},blending:o.NoBlending,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=s,this._hdrCapacityMin=a,this._hdrCapacityMax=l,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){let e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){let t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){let e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class ea extends Error{}class eo extends Error{}let el=(e,t,r)=>{var i;let n;let s=null===(i=e.attributes.getNamedItem(t))||void 0===i?void 0:i.nodeValue;if(s)n=s;else{let i=e.getElementsByTagName(t)[0];if(i){let e=i.getElementsByTagName("rdf:li");if(3===e.length)n=Array.from(e).map(e=>e.innerHTML);else throw Error(`Gainmap metadata contains an array of items for ${t} but its length is not 3`)}else{if(r)return r;throw Error(`Can't find ${t} in gainmap metadata`)}}return n},eh=e=>{var t,r;let i;"undefined"!=typeof TextDecoder?i=new TextDecoder().decode(e):i=e.toString();let n=i.indexOf("<x:xmpmeta"),s=new DOMParser;for(;-1!==n;){let e=i.indexOf("x:xmpmeta>",n);i.slice(n,e+10);let a=i.slice(n,e+10);try{let e=s.parseFromString(a,"text/xml").getElementsByTagName("rdf:Description")[0],i=el(e,"hdrgm:GainMapMin","0"),n=el(e,"hdrgm:GainMapMax"),o=el(e,"hdrgm:Gamma","1"),l=el(e,"hdrgm:OffsetSDR","0.015625"),h=el(e,"hdrgm:OffsetHDR","0.015625"),c=null===(t=e.attributes.getNamedItem("hdrgm:HDRCapacityMin"))||void 0===t?void 0:t.nodeValue;c||(c="0");let d=null===(r=e.attributes.getNamedItem("hdrgm:HDRCapacityMax"))||void 0===r?void 0:r.nodeValue;if(!d)throw Error("Incomplete gainmap metadata");return{gainMapMin:Array.isArray(i)?i.map(e=>parseFloat(e)):[parseFloat(i),parseFloat(i),parseFloat(i)],gainMapMax:Array.isArray(n)?n.map(e=>parseFloat(e)):[parseFloat(n),parseFloat(n),parseFloat(n)],gamma:Array.isArray(o)?o.map(e=>parseFloat(e)):[parseFloat(o),parseFloat(o),parseFloat(o)],offsetSdr:Array.isArray(l)?l.map(e=>parseFloat(e)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(h)?h.map(e=>parseFloat(e)):[parseFloat(h),parseFloat(h),parseFloat(h)],hdrCapacityMin:parseFloat(c),hdrCapacityMax:parseFloat(d)}}catch(e){}n=i.indexOf("<x:xmpmeta",e)}};class ec{constructor(e){this.options={debug:!!e&&void 0!==e.debug&&e.debug,extractFII:!e||void 0===e.extractFII||e.extractFII,extractNonFII:!e||void 0===e.extractNonFII||e.extractNonFII}}extract(e){return new Promise((t,r)=>{let i;let n=this.options.debug,s=new DataView(e.buffer);if(65496!==s.getUint16(0)){r(Error("Not a valid jpeg"));return}let a=s.byteLength,o=2,l=0;for(;o<a;){if(++l>250){r(Error(`Found no marker after ${l} loops 😵`));return}if(255!==s.getUint8(o)){r(Error(`Not a valid marker at offset 0x${o.toString(16)}, found: 0x${s.getUint8(o).toString(16)}`));return}if(i=s.getUint8(o+1),n&&console.log(`Marker: ${i.toString(16)}`),226===i){n&&console.log("Found APP2 marker (0xffe2)");let e=o+4;if(1297106432===s.getUint32(e)){let i;let n=e+4;if(18761===s.getUint16(n))i=!1;else if(19789===s.getUint16(n))i=!0;else{r(Error("No valid endianness marker found in TIFF header"));return}if(42!==s.getUint16(n+2,!i)){r(Error("Not valid TIFF data! (no 0x002A marker)"));return}let a=s.getUint32(n+4,!i);if(a<8){r(Error("Not valid TIFF data! (First offset less than 8)"));return}let o=n+a,l=s.getUint16(o,!i),h=o+2,c=0;for(let e=h;e<h+12*l;e+=12)45057===s.getUint16(e,!i)&&(c=s.getUint32(e+8,!i));let d=o+2+12*l+4,u=[];for(let e=d;e<d+16*c;e+=16){let t={MPType:s.getUint32(e,!i),size:s.getUint32(e+4,!i),dataOffset:s.getUint32(e+8,!i),dependantImages:s.getUint32(e+12,!i),start:-1,end:-1,isFII:!1};t.dataOffset?(t.start=n+t.dataOffset,t.isFII=!1):(t.start=0,t.isFII=!0),t.end=t.start+t.size,u.push(t)}if(this.options.extractNonFII&&u.length){let e=new Blob([s]),r=[];for(let t of u){if(t.isFII&&!this.options.extractFII)continue;let i=e.slice(t.start,t.end+1,"image/jpeg");r.push(i)}t(r)}}}o+=2+s.getUint16(o+2)}})}}let ed=async e=>{let t=eh(e);if(!t)throw new eo("Gain map XMP metadata not found");let r=new ec({extractFII:!0,extractNonFII:!0}),i=await r.extract(e);if(2!==i.length)throw new ea("Gain map recovery image not found");return{sdr:new Uint8Array(await i[0].arrayBuffer()),gainMap:new Uint8Array(await i[1].arrayBuffer()),metadata:t}},eu=e=>new Promise((t,r)=>{let i=document.createElement("img");i.onload=()=>{t(i)},i.onerror=e=>{r(e)},i.src=URL.createObjectURL(e)});class em extends o.Loader{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new o.LoadingManager}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");let e=new es({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new o.Texture,sdr:new o.Texture});return new er({width:16,height:16,type:o.HalfFloatType,colorSpace:o.LinearSRGBColorSpace,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,r,i){let n,s;let a=i?new Blob([i],{type:"image/jpeg"}):void 0,l=new Blob([r],{type:"image/jpeg"}),h=!1;if("undefined"==typeof createImageBitmap){let e=await Promise.all([a?eu(a):Promise.resolve(void 0),eu(l)]);s=e[0],n=e[1],h=!0}else{let e=await Promise.all([a?createImageBitmap(a,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(l,{imageOrientation:"flipY"})]);s=e[0],n=e[1]}let c=new o.Texture(s||new ImageData(2,2),o.UVMapping,o.ClampToEdgeWrapping,o.ClampToEdgeWrapping,o.LinearFilter,o.LinearMipMapLinearFilter,o.RGBAFormat,o.UnsignedByteType,1,o.LinearSRGBColorSpace);c.flipY=h,c.needsUpdate=!0;let d=new o.Texture(n,o.UVMapping,o.ClampToEdgeWrapping,o.ClampToEdgeWrapping,o.LinearFilter,o.LinearMipMapLinearFilter,o.RGBAFormat,o.UnsignedByteType,1,o.SRGBColorSpace);d.flipY=h,d.needsUpdate=!0,e.width=n.width,e.height=n.height,e.material.gainMap=c,e.material.sdr=d,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class eA extends em{load([e,t,r],i,n,s){let a,l,h;let c=this.prepareQuadRenderer(),d=async()=>{if(a&&l&&h){try{await this.render(c,h,a,l)}catch(i){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(r),"function"==typeof s&&s(i),c.disposeOnDemandRenderer();return}"function"==typeof i&&i(c),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(r),c.disposeOnDemandRenderer()}},u=!0,m=0,A=0,p=!0,f=0,B=0,g=!0,C=0,_=0,v=()=>{"function"==typeof n&&n(new ProgressEvent("progress",{lengthComputable:u&&p&&g,loaded:A+B+_,total:m+f+C}))};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(r);let E=new o.FileLoader(this._internalLoadingManager);E.setResponseType("arraybuffer"),E.setRequestHeader(this.requestHeader),E.setPath(this.path),E.setWithCredentials(this.withCredentials),E.load(e,async e=>{if("string"==typeof e)throw Error("Invalid sdr buffer");a=e,await d()},e=>{u=e.lengthComputable,A=e.loaded,m=e.total,v()},t=>{this.manager.itemError(e),"function"==typeof s&&s(t)});let y=new o.FileLoader(this._internalLoadingManager);y.setResponseType("arraybuffer"),y.setRequestHeader(this.requestHeader),y.setPath(this.path),y.setWithCredentials(this.withCredentials),y.load(t,async e=>{if("string"==typeof e)throw Error("Invalid gainmap buffer");l=e,await d()},e=>{p=e.lengthComputable,B=e.loaded,f=e.total,v()},e=>{this.manager.itemError(t),"function"==typeof s&&s(e)});let T=new o.FileLoader(this._internalLoadingManager);return T.setRequestHeader(this.requestHeader),T.setPath(this.path),T.setWithCredentials(this.withCredentials),T.load(r,async e=>{if("string"!=typeof e)throw Error("Invalid metadata string");h=JSON.parse(e),await d()},e=>{g=e.lengthComputable,_=e.loaded,C=e.total,v()},e=>{this.manager.itemError(r),"function"==typeof s&&s(e)}),c}}class ep extends em{load(e,t,r,i){let n=this.prepareQuadRenderer(),s=new o.FileLoader(this._internalLoadingManager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(this.withCredentials),this.manager.itemStart(e),s.load(e,async r=>{let s,a,o;if("string"==typeof r)throw Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");let l=new Uint8Array(r);try{let e=await ed(l);s=e.sdr,a=e.gainMap,o=e.metadata}catch(t){if(t instanceof eo||t instanceof ea)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),o={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},s=l;else throw t}try{await this.render(n,o,s,a)}catch(t){this.manager.itemError(e),"function"==typeof i&&i(t),n.disposeOnDemandRenderer();return}"function"==typeof t&&t(n),this.manager.itemEnd(e),n.disposeOnDemandRenderer()},r,t=>{this.manager.itemError(e),"function"==typeof i&&i(t)}),n}}let ef={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"};var eB=r(6078);let eg=e=>Array.isArray(e);function eC({files:e=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:t="",preset:r,encoding:i,extensions:n}={}){var l,h;let d=null,u=!1;if(r){if(!(r in ef))throw Error("Preset must be one of: "+Object.keys(ef).join(", "));e=ef[r],t="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/"}let m=eg(e)&&6===e.length,A=eg(e)&&3===e.length&&e.some(e=>e.endsWith("json")),p=eg(e)?e[0]:e;u=eg(e);let f=m?"cube":A?"webp":p.startsWith("data:application/exr")?"exr":p.startsWith("data:application/hdr")?"hdr":p.startsWith("data:image/jpeg")?"jpg":null==(l=p.split(".").pop())||null==(l=l.split("?"))||null==(l=l.shift())?void 0:l.toLowerCase();if(!(d="cube"===f?o.CubeTextureLoader:"hdr"===f?c:"exr"===f?$:"jpg"===f||"jpeg"===f?ep:"webp"===f?eA:null))throw Error("useEnvironment: Unrecognized file extension: "+e);let B=(0,a.A)(e=>e.gl);(0,s.useLayoutEffect)(()=>{("webp"===f||"jpg"===f||"jpeg"===f)&&B.domElement.addEventListener("webglcontextlost",function(){a.F.clear(d,u?[e]:e)},{once:!0})},[e,B.domElement]);let g=(0,a.F)(d,u?[e]:e,e=>{("webp"===f||"jpg"===f||"jpeg"===f)&&e.setRenderer(B),null==e.setPath||e.setPath(t),n&&n(e)}),C=u?g[0]:g;return("jpg"===f||"jpeg"===f||"webp"===f)&&(C=null==(h=C.renderTarget)?void 0:h.texture),C.mapping=m?o.CubeReflectionMapping:o.EquirectangularReflectionMapping,"colorSpace"in C?C.colorSpace=(null!=i?i:m)?"srgb":"srgb-linear":C.encoding=(null!=i?i:m)?eB.kn:eB.rn,C}let e_=e=>e.current&&e.current.isScene,ev=e=>e_(e)?e.current:e;function eE(e,t,r,i,n={}){var s,o,l,h,c;n={backgroundBlurriness:null!==(s=n.blur)&&void 0!==s?s:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...n};let d=ev(t||r),u=d.background,m=d.environment,A={backgroundBlurriness:d.backgroundBlurriness,backgroundIntensity:d.backgroundIntensity,backgroundRotation:null!==(o=null==(l=d.backgroundRotation)||null==l.clone?void 0:l.clone())&&void 0!==o?o:[0,0,0],environmentIntensity:d.environmentIntensity,environmentRotation:null!==(h=null==(c=d.environmentRotation)||null==c.clone?void 0:c.clone())&&void 0!==h?h:[0,0,0]};return"only"!==e&&(d.environment=i),e&&(d.background=i),(0,a.j)(d,n),()=>{"only"!==e&&(d.environment=m),e&&(d.background=u),(0,a.j)(d,A)}}function ey({scene:e,background:t=!1,map:r,...i}){let n=(0,a.A)(e=>e.scene);return s.useLayoutEffect(()=>{if(r)return eE(t,e,n,r,i)}),null}function eT({background:e=!1,scene:t,blur:r,backgroundBlurriness:i,backgroundIntensity:n,backgroundRotation:o,environmentIntensity:l,environmentRotation:h,...c}){let d=eC(c),u=(0,a.A)(e=>e.scene);return s.useLayoutEffect(()=>eE(e,t,u,d,{blur:r,backgroundBlurriness:i,backgroundIntensity:n,backgroundRotation:o,environmentIntensity:l,environmentRotation:h})),null}function eM({children:e,near:t=1,far:r=1e3,resolution:i=256,frames:n=1,map:l,background:h=!1,blur:c,backgroundBlurriness:d,backgroundIntensity:u,backgroundRotation:m,environmentIntensity:A,environmentRotation:p,scene:f,files:B,path:g,preset:C,extensions:_}){let v=(0,a.A)(e=>e.gl),E=(0,a.A)(e=>e.scene),y=s.useRef(null),[T]=s.useState(()=>new o.Scene),M=s.useMemo(()=>{let e=new o.WebGLCubeRenderTarget(i);return e.texture.type=o.HalfFloatType,e},[i]);s.useLayoutEffect(()=>(1===n&&y.current.update(v,T),eE(h,f,E,M.texture,{blur:c,backgroundBlurriness:d,backgroundIntensity:u,backgroundRotation:m,environmentIntensity:A,environmentRotation:p})),[e,T,M.texture,f,E,h,n,v]);let F=1;return(0,a.C)(()=>{(n===1/0||F<n)&&(y.current.update(v,T),F++)}),s.createElement(s.Fragment,null,(0,a.g)(s.createElement(s.Fragment,null,e,s.createElement("cubeCamera",{ref:y,args:[t,r,M]}),B||C?s.createElement(eT,{background:!0,files:B,preset:C,path:g,extensions:_}):l?s.createElement(ey,{background:!0,map:l,extensions:_}):null),T))}function eF(e){var t,r,i,o;let l=eC(e),c=e.map||l;s.useMemo(()=>(0,a.e)({GroundProjectedEnvImpl:h}),[]);let d=s.useMemo(()=>[c],[c]),u=null==(t=e.ground)?void 0:t.height,m=null==(r=e.ground)?void 0:r.radius,A=null!==(i=null==(o=e.ground)?void 0:o.scale)&&void 0!==i?i:1e3;return s.createElement(s.Fragment,null,s.createElement(ey,(0,n.Z)({},e,{map:c})),s.createElement("groundProjectedEnvImpl",{args:d,scale:A,height:u,radius:m}))}function eR(e){return e.ground?s.createElement(eF,e):e.map?s.createElement(ey,e):e.children?s.createElement(eM,e):s.createElement(eT,e)}},7840:function(e,t,r){"use strict";let i;r.d(t,{L:function(){return ec}}),r(2265);var n=r(7776);let s=new WeakMap;class a extends n.Loader{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){let s=new n.FileLoader(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,e=>{let r={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,r).then(t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){let r;for(let e in t.attributeTypes){let r=t.attributeTypes[e];void 0!==r.BYTES_PER_ELEMENT&&(t.attributeTypes[e]=r.name)}let i=JSON.stringify(t);if(s.has(e)){let t=s.get(e);if(t.key===i)return t.promise;if(0===e.byteLength)throw Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n=this.workerNextTaskID++,a=e.byteLength,o=this._getWorker(n,a).then(i=>(r=i,new Promise((i,s)=>{r._callbacks[n]={resolve:i,reject:s},r.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return o.catch(()=>!0).then(()=>{r&&n&&this._releaseTask(r,n)}),s.set(e,{key:i,promise:o}),o}_createGeometry(e){let t=new n.BufferGeometry;e.index&&t.setIndex(new n.BufferAttribute(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let i=e.attributes[r],s=i.name,a=i.array,o=i.itemSize;t.setAttribute(s,new n.BufferAttribute(a,o))}return t}_loadLibrary(e,t){let r=new n.FileLoader(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((t,i)=>{r.load(e,t,void 0,i)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{let r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let i=o.toString(),n=["/* draco decoder */",r,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function o(){let e,t;onmessage=function(r){let i=r.data;switch(i.type){case"init":e=i.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":let n=i.buffer,s=i.taskConfig;t.then(e=>{let t=e.draco,r=new t.Decoder,a=new t.DecoderBuffer;a.Init(new Int8Array(n),n.byteLength);try{let e=function(e,t,r,i){let n,s;let a=i.attributeIDs,o=i.attributeTypes,l=t.GetEncodedGeometryType(r);if(l===e.TRIANGULAR_MESH)n=new e.Mesh,s=t.DecodeBufferToMesh(r,n);else if(l===e.POINT_CLOUD)n=new e.PointCloud,s=t.DecodeBufferToPointCloud(r,n);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!s.ok()||0===n.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+s.error_msg());let h={index:null,attributes:[]};for(let r in a){let s,l;let c=self[o[r]];if(i.useUniqueIDs)l=a[r],s=t.GetAttributeByUniqueId(n,l);else{if(-1===(l=t.GetAttributeId(n,e[a[r]])))continue;s=t.GetAttribute(n,l)}h.attributes.push(function(e,t,r,i,n,s){let a=s.num_components(),o=r.num_points()*a,l=o*n.BYTES_PER_ELEMENT,h=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,n),c=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,s,h,l,c);let d=new n(e.HEAPF32.buffer,c,o).slice();return e._free(c),{name:i,array:d,itemSize:a}}(e,t,n,r,c,s))}return l===e.TRIANGULAR_MESH&&(h.index=function(e,t,r){let i=3*r.num_faces(),n=4*i,s=e._malloc(n);t.GetTrianglesUInt32Array(r,n,s);let a=new Uint32Array(e.HEAPF32.buffer,s,i).slice();return e._free(s),{array:a,itemSize:1}}(e,t,n)),e.destroy(n),h}(t,r,a,s),n=e.attributes.map(e=>e.array.buffer);e.index&&n.push(e.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:e},n)}catch(e){console.error(e),self.postMessage({type:"error",id:i.id,error:e.message})}finally{t.destroy(a),t.destroy(r)}})}}}let l=()=>{let e;if(i)return i;let t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!=typeof WebAssembly)return{supported:!1};let n="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";WebAssembly.validate(t)&&(n="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");let s=WebAssembly.instantiate(function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;++r){let i=e.charCodeAt(r);t[r]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let i=0;for(let n=0;n<e.length;++n)t[i++]=t[n]<60?r[t[n]]:(t[n]-60)*64+t[++n];return t.buffer.slice(0,i)}(n),{}).then(t=>{(e=t.instance).exports.__wasm_call_ctors()});function a(t,r,i,n,s,a){let o=e.exports.sbrk,l=i+3&-4,h=o(l*n),c=o(s.length),d=new Uint8Array(e.exports.memory.buffer);d.set(s,c);let u=t(h,i,n,c,s.length);if(0===u&&a&&a(h,l,n),r.set(d.subarray(h,h+i*n)),o(h-o(0)),0!==u)throw Error(`Malformed buffer data: ${u}`)}let o={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},l={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return i={ready:s,supported:!0,decodeVertexBuffer(t,r,i,n,s){a(e.exports.meshopt_decodeVertexBuffer,t,r,i,n,e.exports[o[s]])},decodeIndexBuffer(t,r,i,n){a(e.exports.meshopt_decodeIndexBuffer,t,r,i,n)},decodeIndexSequence(t,r,i,n){a(e.exports.meshopt_decodeIndexSequence,t,r,i,n)},decodeGltfBuffer(t,r,i,n,s,h){a(e.exports[l[s]],t,r,i,n,e.exports[o[h]])}}};function h(e,t){if(t===n.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==n.TriangleFanDrawMode&&t!==n.TriangleStripDrawMode)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let r=e.getIndex();if(null===r){let t=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}let i=r.count-2,s=[];if(r){if(t===n.TriangleFanDrawMode)for(let e=1;e<=i;e++)s.push(r.getX(0)),s.push(r.getX(e)),s.push(r.getX(e+1));else for(let e=0;e<i;e++)e%2==0?(s.push(r.getX(e)),s.push(r.getX(e+1)),s.push(r.getX(e+2))):(s.push(r.getX(e+2)),s.push(r.getX(e+1)),s.push(r.getX(e)))}s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=e.clone();return a.setIndex(s),a.clearGroups(),a}}var c=r(6231);function d(e){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(e){return t}}let u="srgb",m="srgb-linear";class A extends n.Loader{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new _(e)}),this.register(function(e){return new v(e)}),this.register(function(e){return new O(e)}),this.register(function(e){return new x(e)}),this.register(function(e){return new I(e)}),this.register(function(e){return new y(e)}),this.register(function(e){return new T(e)}),this.register(function(e){return new M(e)}),this.register(function(e){return new F(e)}),this.register(function(e){return new C(e)}),this.register(function(e){return new R(e)}),this.register(function(e){return new E(e)}),this.register(function(e){return new D(e)}),this.register(function(e){return new b(e)}),this.register(function(e){return new B(e)}),this.register(function(e){return new w(e)}),this.register(function(e){return new U(e)})}load(e,t,r,i){let s;let a=this;if(""!==this.resourcePath)s=this.resourcePath;else if(""!==this.path){let t=n.LoaderUtils.extractUrlBase(e);s=n.LoaderUtils.resolveURL(t,this.path)}else s=n.LoaderUtils.extractUrlBase(e);this.manager.itemStart(e);let o=function(t){i?i(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},l=new n.FileLoader(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(r){try{a.parse(r,s,function(r){t(r),a.manager.itemEnd(e)},o)}catch(e){o(e)}},r,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let n;let s={},a={};if("string"==typeof e)n=JSON.parse(e);else if(e instanceof ArrayBuffer){if(d(new Uint8Array(e.slice(0,4)))===H){try{s[f.KHR_BINARY_GLTF]=new L(e)}catch(e){i&&i(e);return}n=JSON.parse(s[f.KHR_BINARY_GLTF].content)}else n=JSON.parse(d(new Uint8Array(e)))}else n=e;if(void 0===n.asset||n.asset.version[0]<2){i&&i(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let o=new en(n,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});o.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t=this.pluginCallbacks[e](o);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[t.name]=t,s[t.name]=!0}if(n.extensionsUsed)for(let e=0;e<n.extensionsUsed.length;++e){let t=n.extensionsUsed[e],r=n.extensionsRequired||[];switch(t){case f.KHR_MATERIALS_UNLIT:s[t]=new g;break;case f.KHR_DRACO_MESH_COMPRESSION:s[t]=new S(n,this.dracoLoader);break;case f.KHR_TEXTURE_TRANSFORM:s[t]=new P;break;case f.KHR_MESH_QUANTIZATION:s[t]=new J;break;default:r.indexOf(t)>=0&&void 0===a[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}o.setExtensions(s),o.setPlugins(a),o.parse(r,i)}parseAsync(e,t){let r=this;return new Promise(function(i,n){r.parse(e,t,i,n)})}}function p(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}let f={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class B{constructor(e){this.parser=e,this.name=f.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){let i=t[r];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){let t;let r=this.parser,i="light:"+e,s=r.cache.get(i);if(s)return s;let a=r.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e],l=new n.Color(16777215);void 0!==o.color&&l.setRGB(o.color[0],o.color[1],o.color[2],m);let h=void 0!==o.range?o.range:0;switch(o.type){case"directional":(t=new n.DirectionalLight(l)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new n.PointLight(l)).distance=h;break;case"spot":(t=new n.SpotLight(l)).distance=h,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,t.angle=o.spot.outerConeAngle,t.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return t.position.set(0,0,0),t.decay=2,ee(t,o),void 0!==o.intensity&&(t.intensity=o.intensity),t.name=r.createUniqueName(o.name||"light_"+e),s=Promise.resolve(t),r.cache.add(i,s),s}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){let t=this,r=this.parser,i=r.json.nodes[e],n=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then(function(e){return r._getNodeRef(t.cache,n,e)})}}class g{constructor(){this.name=f.KHR_MATERIALS_UNLIT}getMaterialType(){return n.MeshBasicMaterial}extendParams(e,t,r){let i=[];e.color=new n.Color(1,1,1),e.opacity=1;let s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){let t=s.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],m),e.opacity=t[3]}void 0!==s.baseColorTexture&&i.push(r.assignTexture(e,"map",s.baseColorTexture,u))}return Promise.all(i)}}class C{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let i=r.extensions[this.name].emissiveStrength;return void 0!==i&&(t.emissiveIntensity=i),Promise.resolve()}}class _{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],a=i.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&s.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(s.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){let e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new n.Vector2(e,e)}return Promise.all(s)}}class v{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_DISPERSION}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let i=r.extensions[this.name];return t.dispersion=void 0!==i.dispersion?i.dispersion:0,Promise.resolve()}}class E{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let n=[],s=i.extensions[this.name];return void 0!==s.iridescenceFactor&&(t.iridescence=s.iridescenceFactor),void 0!==s.iridescenceTexture&&n.push(r.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),void 0!==s.iridescenceIor&&(t.iridescenceIOR=s.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==s.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),void 0!==s.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),void 0!==s.iridescenceThicknessTexture&&n.push(r.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(n)}}class y{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_SHEEN}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[];t.sheenColor=new n.Color(0,0,0),t.sheenRoughness=0,t.sheen=1;let a=i.extensions[this.name];if(void 0!==a.sheenColorFactor){let e=a.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],m)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&s.push(r.assignTexture(t,"sheenColorMap",a.sheenColorTexture,u)),void 0!==a.sheenRoughnessTexture&&s.push(r.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class T{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let n=[],s=i.extensions[this.name];return void 0!==s.transmissionFactor&&(t.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&n.push(r.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(n)}}class M{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_VOLUME}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],a=i.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&s.push(r.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;let o=a.attenuationColor||[1,1,1];return t.attenuationColor=new n.Color().setRGB(o[0],o[1],o[2],m),Promise.all(s)}}class F{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_IOR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let i=r.extensions[this.name];return t.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}class R{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_SPECULAR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],a=i.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&s.push(r.assignTexture(t,"specularIntensityMap",a.specularTexture));let o=a.specularColorFactor||[1,1,1];return t.specularColor=new n.Color().setRGB(o[0],o[1],o[2],m),void 0!==a.specularColorTexture&&s.push(r.assignTexture(t,"specularColorMap",a.specularColorTexture,u)),Promise.all(s)}}class b{constructor(e){this.parser=e,this.name=f.EXT_MATERIALS_BUMP}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let n=[],s=i.extensions[this.name];return t.bumpScale=void 0!==s.bumpFactor?s.bumpFactor:1,void 0!==s.bumpTexture&&n.push(r.assignTexture(t,"bumpMap",s.bumpTexture)),Promise.all(n)}}class D{constructor(e){this.parser=e,this.name=f.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let n=[],s=i.extensions[this.name];return void 0!==s.anisotropyStrength&&(t.anisotropy=s.anisotropyStrength),void 0!==s.anisotropyRotation&&(t.anisotropyRotation=s.anisotropyRotation),void 0!==s.anisotropyTexture&&n.push(r.assignTexture(t,"anisotropyMap",s.anisotropyTexture)),Promise.all(n)}}class O{constructor(e){this.parser=e,this.name=f.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;let n=i.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(!(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return t.loadTextureImage(e,n.source,s)}}class x{constructor(e){this.parser=e,this.name=f.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,i=r.json,n=i.textures[e];if(!n.extensions||!n.extensions[t])return null;let s=n.extensions[t],a=i.images[s.source],o=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(n){if(n)return r.loadTextureImage(e,s.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class I{constructor(e){this.parser=e,this.name=f.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,i=r.json,n=i.textures[e];if(!n.extensions||!n.extensions[t])return null;let s=n.extensions[t],a=i.images[s.source],o=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(n){if(n)return r.loadTextureImage(e,s.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class w{constructor(e){this.name=f.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;{let e=r.extensions[this.name],i=this.parser.getDependency("buffer",e.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(!(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return i.then(function(t){let r=e.byteOffset||0,i=e.byteLength||0,s=e.count,a=e.byteStride,o=new Uint8Array(t,r,i);return n.decodeGltfBufferAsync?n.decodeGltfBufferAsync(s,a,o,e.mode,e.filter).then(function(e){return e.buffer}):n.ready.then(function(){let t=new ArrayBuffer(s*a);return n.decodeGltfBuffer(new Uint8Array(t),s,a,o,e.mode,e.filter),t})})}}}class U{constructor(e){this.name=f.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;for(let e of t.meshes[r.mesh].primitives)if(e.mode!==Q.TRIANGLES&&e.mode!==Q.TRIANGLE_STRIP&&e.mode!==Q.TRIANGLE_FAN&&void 0!==e.mode)return null;let i=r.extensions[this.name].attributes,s=[],a={};for(let e in i)s.push(this.parser.getDependency("accessor",i[e]).then(t=>(a[e]=t,a[e])));return s.length<1?null:(s.push(this.parser.createNodeMesh(e)),Promise.all(s).then(e=>{let t=e.pop(),r=t.isGroup?t.children:[t],i=e[0].count,s=[];for(let e of r){let t=new n.Matrix4,r=new n.Vector3,o=new n.Quaternion,l=new n.Vector3(1,1,1),h=new n.InstancedMesh(e.geometry,e.material,i);for(let e=0;e<i;e++)a.TRANSLATION&&r.fromBufferAttribute(a.TRANSLATION,e),a.ROTATION&&o.fromBufferAttribute(a.ROTATION,e),a.SCALE&&l.fromBufferAttribute(a.SCALE,e),h.setMatrixAt(e,t.compose(r,o,l));for(let t in a)if("_COLOR_0"===t){let e=a[t];h.instanceColor=new n.InstancedBufferAttribute(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,a[t]);n.Object3D.prototype.copy.call(h,e),this.parser.assignFinalMaterial(h),s.push(h)}return t.isGroup?(t.clear(),t.add(...s),t):s[0]}))}}let H="glTF",G={JSON:1313821514,BIN:5130562};class L{constructor(e){this.name=f.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,12);if(this.header={magic:d(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==H)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-12,i=new DataView(e,12),n=0;for(;n<r;){let t=i.getUint32(n,!0);n+=4;let r=i.getUint32(n,!0);if(n+=4,r===G.JSON){let r=new Uint8Array(e,12+n,t);this.content=d(r)}else if(r===G.BIN){let r=12+n;this.body=e.slice(r,r+t)}n+=t}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class S{constructor(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=f.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let r=this.json,i=this.dracoLoader,n=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},o={},l={};for(let e in s)a[z[e]||e.toLowerCase()]=s[e];for(let t in e.attributes){let i=z[t]||t.toLowerCase();if(void 0!==s[t]){let n=r.accessors[e.attributes[t]],s=j[n.componentType];l[i]=s.name,o[i]=!0===n.normalized}}return t.getDependency("bufferView",n).then(function(e){return new Promise(function(t,r){i.decodeDracoFile(e,function(e){for(let t in e.attributes){let r=e.attributes[t],i=o[t];void 0!==i&&(r.normalized=i)}t(e)},a,l,m,r)})})}}class P{constructor(){this.name=f.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class J{constructor(){this.name=f.KHR_MESH_QUANTIZATION}}class N extends n.Interpolant{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i*3+i;for(let e=0;e!==i;e++)t[e]=r[n+e];return t}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=2*a,l=3*a,h=i-t,c=(r-t)/h,d=c*c,u=d*c,m=e*l,A=m-l,p=-2*u+3*d,f=u-d,B=1-p,g=f-d+c;for(let e=0;e!==a;e++){let t=s[A+e+a],r=s[A+e+o]*h,i=s[m+e+a],l=s[m+e]*h;n[e]=B*t+g*r+p*i+f*l}return n}}let k=new n.Quaternion;class K extends N{interpolate_(e,t,r,i){let n=super.interpolate_(e,t,r,i);return k.fromArray(n).normalize().toArray(n),n}}let Q={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},j={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Y={9728:n.NearestFilter,9729:n.LinearFilter,9984:n.NearestMipmapNearestFilter,9985:n.LinearMipmapNearestFilter,9986:n.NearestMipmapLinearFilter,9987:n.LinearMipmapLinearFilter},X={33071:n.ClampToEdgeWrapping,33648:n.MirroredRepeatWrapping,10497:n.RepeatWrapping},V={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},z={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...c.i>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Z={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},W={CUBICSPLINE:void 0,LINEAR:n.InterpolateLinear,STEP:n.InterpolateDiscrete},q={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function $(e,t,r){for(let i in r.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=r.extensions[i])}function ee(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function et(e){let t="",r=Object.keys(e).sort();for(let i=0,n=r.length;i<n;i++)t+=r[i]+":"+e[r[i]]+";";return t}function er(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}let ei=new n.Matrix4;class en{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new p,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=!1,s=-1;"undefined"!=typeof navigator&&void 0!==navigator.userAgent&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),s=(i=navigator.userAgent.indexOf("Firefox")>-1)?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||r||i&&s<98?this.textureLoader=new n.TextureLoader(this.options.manager):this.textureLoader=new n.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new n.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,i=this.json,n=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(t){let s={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:r,userData:{}};return $(n,s,i),ee(s,i),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(s)})).then(function(){for(let e of s.scenes)e.updateMatrixWorld();e(s)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,i=t.length;r<i;r++){let i=t[r].joints;for(let t=0,r=i.length;t<r;t++)e[i[t]].isBone=!0}for(let t=0,i=e.length;t<i;t++){let i=e[t];void 0!==i.mesh&&(this._addNodeRef(this.meshCache,i.mesh),void 0!==i.skin&&(r[i.mesh].isSkinnedMesh=!0)),void 0!==i.camera&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let i=r.clone(),n=(e,t)=>{let r=this.associations.get(e);for(let[i,s]of(null!=r&&this.associations.set(t,r),e.children.entries()))n(s,t.children[i])};return n(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let i=e(t[r]);if(i)return i}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let i=0;i<t.length;i++){let n=e(t[i]);n&&r.push(n)}return r}getDependency(e,t){let r=e+":"+t,i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":i=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(!(i=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})))throw Error("Unknown type: "+e)}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(t,i){return r.getDependency(e,i)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[f.KHR_BINARY_GLTF].body);let i=this.options;return new Promise(function(e,s){r.load(n.LoaderUtils.resolveURL(t.uri,i.path),e,void 0,function(){s(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){let r=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+r)})}loadAccessor(e){let t=this,r=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse){let e=V[i.type],t=j[i.componentType],r=!0===i.normalized,s=new t(i.count*e);return Promise.resolve(new n.BufferAttribute(s,e,r))}let s=[];return void 0!==i.bufferView?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),void 0!==i.sparse&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(e){let s,a;let o=e[0],l=V[i.type],h=j[i.componentType],c=h.BYTES_PER_ELEMENT,d=c*l,u=i.byteOffset||0,m=void 0!==i.bufferView?r.bufferViews[i.bufferView].byteStride:void 0,A=!0===i.normalized;if(m&&m!==d){let e=Math.floor(u/m),r="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+e+":"+i.count,d=t.cache.get(r);d||(s=new h(o,e*m,i.count*m/c),d=new n.InterleavedBuffer(s,m/c),t.cache.add(r,d)),a=new n.InterleavedBufferAttribute(d,l,u%m/c,A)}else s=null===o?new h(i.count*l):new h(o,u,i.count*l),a=new n.BufferAttribute(s,l,A);if(void 0!==i.sparse){let t=V.SCALAR,r=j[i.sparse.indices.componentType],s=i.sparse.indices.byteOffset||0,c=i.sparse.values.byteOffset||0,d=new r(e[1],s,i.sparse.count*t),u=new h(e[2],c,i.sparse.count*l);null!==o&&(a=new n.BufferAttribute(a.array.slice(),a.itemSize,a.normalized));for(let e=0,t=d.length;e<t;e++){let t=d[e];if(a.setX(t,u[e*l]),l>=2&&a.setY(t,u[e*l+1]),l>=3&&a.setZ(t,u[e*l+2]),l>=4&&a.setW(t,u[e*l+3]),l>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a})}loadTexture(e){let t=this.json,r=this.options,i=t.textures[e].source,n=t.images[i],s=this.textureLoader;if(n.uri){let e=r.manager.getHandler(n.uri);null!==e&&(s=e)}return this.loadTextureImage(e,i,s)}loadTextureImage(e,t,r){let i=this,s=this.json,a=s.textures[e],o=s.images[t],l=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];let h=this.loadImageSource(t,r).then(function(t){t.flipY=!1,t.name=a.name||o.name||"",""===t.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);let r=(s.samplers||{})[a.sampler]||{};return t.magFilter=Y[r.magFilter]||n.LinearFilter,t.minFilter=Y[r.minFilter]||n.LinearMipmapLinearFilter,t.wrapS=X[r.wrapS]||n.RepeatWrapping,t.wrapT=X[r.wrapT]||n.RepeatWrapping,i.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[l]=h,h}loadImageSource(e,t){let r=this.json,i=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let s=r.images[e],a=self.URL||self.webkitURL,o=s.uri||"",l=!1;if(void 0!==s.bufferView)o=this.getDependency("bufferView",s.bufferView).then(function(e){l=!0;let t=new Blob([e],{type:s.mimeType});return o=a.createObjectURL(t)});else if(void 0===s.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let h=Promise.resolve(o).then(function(e){return new Promise(function(r,s){let a=r;!0===t.isImageBitmapLoader&&(a=function(e){let t=new n.Texture(e);t.needsUpdate=!0,r(t)}),t.load(n.LoaderUtils.resolveURL(e,i.path),a,void 0,s)})}).then(function(e){var t;return!0===l&&a.revokeObjectURL(o),ee(e,s),e.userData.mimeType=s.mimeType||((t=s.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=h,h}assignTexture(e,t,r,i){let n=this;return this.getDependency("texture",r.index).then(function(s){if(!s)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((s=s.clone()).channel=r.texCoord),n.extensions[f.KHR_TEXTURE_TRANSFORM]){let e=void 0!==r.extensions?r.extensions[f.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let t=n.associations.get(s);s=n.extensions[f.KHR_TEXTURE_TRANSFORM].extendTexture(s,e),n.associations.set(s,t)}}return void 0!==i&&("number"==typeof i&&(i=3001===i?u:m),"colorSpace"in s?s.colorSpace=i:s.encoding=i===u?3001:3e3),e[t]=s,s})}assignFinalMaterial(e){let t=e.geometry,r=e.material,i=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new n.PointsMaterial,n.Material.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){let e="LineBasicMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new n.LineBasicMaterial,n.Material.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,this.cache.add(e,t)),r=t}if(i||s||a){let e="ClonedMaterial:"+r.uuid+":";i&&(e+="derivative-tangents:"),s&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),s&&(t.vertexColors=!0),a&&(t.flatShading=!0),i&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}e.material=r}getMaterialType(){return n.MeshStandardMaterial}loadMaterial(e){let t;let r=this,i=this.json,s=this.extensions,a=i.materials[e],o={},l=a.extensions||{},h=[];if(l[f.KHR_MATERIALS_UNLIT]){let e=s[f.KHR_MATERIALS_UNLIT];t=e.getMaterialType(),h.push(e.extendParams(o,a,r))}else{let i=a.pbrMetallicRoughness||{};if(o.color=new n.Color(1,1,1),o.opacity=1,Array.isArray(i.baseColorFactor)){let e=i.baseColorFactor;o.color.setRGB(e[0],e[1],e[2],m),o.opacity=e[3]}void 0!==i.baseColorTexture&&h.push(r.assignTexture(o,"map",i.baseColorTexture,u)),o.metalness=void 0!==i.metallicFactor?i.metallicFactor:1,o.roughness=void 0!==i.roughnessFactor?i.roughnessFactor:1,void 0!==i.metallicRoughnessTexture&&(h.push(r.assignTexture(o,"metalnessMap",i.metallicRoughnessTexture)),h.push(r.assignTexture(o,"roughnessMap",i.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)})))}!0===a.doubleSided&&(o.side=n.DoubleSide);let c=a.alphaMode||q.OPAQUE;if(c===q.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,c===q.MASK&&(o.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==n.MeshBasicMaterial&&(h.push(r.assignTexture(o,"normalMap",a.normalTexture)),o.normalScale=new n.Vector2(1,1),void 0!==a.normalTexture.scale)){let e=a.normalTexture.scale;o.normalScale.set(e,e)}if(void 0!==a.occlusionTexture&&t!==n.MeshBasicMaterial&&(h.push(r.assignTexture(o,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(o.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==n.MeshBasicMaterial){let e=a.emissiveFactor;o.emissive=new n.Color().setRGB(e[0],e[1],e[2],m)}return void 0!==a.emissiveTexture&&t!==n.MeshBasicMaterial&&h.push(r.assignTexture(o,"emissiveMap",a.emissiveTexture,u)),Promise.all(h).then(function(){let i=new t(o);return a.name&&(i.name=a.name),ee(i,a),r.associations.set(i,{materials:e}),a.extensions&&$(s,i,a),i})}createUniqueName(e){let t=n.PropertyBinding.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,r=this.extensions,i=this.primitiveCache,s=[];for(let a=0,o=e.length;a<o;a++){let o=e[a],l=function(e){let t;let r=e.extensions&&e.extensions[f.KHR_DRACO_MESH_COMPRESSION];if(t=r?"draco:"+r.bufferView+":"+r.indices+":"+et(r.attributes):e.indices+":"+et(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,i=e.targets.length;r<i;r++)t+=":"+et(e.targets[r]);return t}(o),h=i[l];if(h)s.push(h.promise);else{let e;e=o.extensions&&o.extensions[f.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[f.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return es(r,e,t)})}(o):es(new n.BufferGeometry,o,t),i[l]={primitive:o,promise:e},s.push(e)}}return Promise.all(s)}loadMesh(e){let t=this,r=this.json,i=this.extensions,s=r.meshes[e],a=s.primitives,o=[];for(let e=0,t=a.length;e<t;e++){var l;let t=void 0===a[e].material?(void 0===(l=this.cache).DefaultMaterial&&(l.DefaultMaterial=new n.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.FrontSide})),l.DefaultMaterial):this.getDependency("material",a[e].material);o.push(t)}return o.push(t.loadGeometries(a)),Promise.all(o).then(function(r){let o=r.slice(0,r.length-1),l=r[r.length-1],c=[];for(let r=0,d=l.length;r<d;r++){let d;let u=l[r],m=a[r],A=o[r];if(m.mode===Q.TRIANGLES||m.mode===Q.TRIANGLE_STRIP||m.mode===Q.TRIANGLE_FAN||void 0===m.mode)!0===(d=!0===s.isSkinnedMesh?new n.SkinnedMesh(u,A):new n.Mesh(u,A)).isSkinnedMesh&&d.normalizeSkinWeights(),m.mode===Q.TRIANGLE_STRIP?d.geometry=h(d.geometry,n.TriangleStripDrawMode):m.mode===Q.TRIANGLE_FAN&&(d.geometry=h(d.geometry,n.TriangleFanDrawMode));else if(m.mode===Q.LINES)d=new n.LineSegments(u,A);else if(m.mode===Q.LINE_STRIP)d=new n.Line(u,A);else if(m.mode===Q.LINE_LOOP)d=new n.LineLoop(u,A);else if(m.mode===Q.POINTS)d=new n.Points(u,A);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(d.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,i=t.weights.length;r<i;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){let r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,i=r.length;t<i;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(d,s),d.name=t.createUniqueName(s.name||"mesh_"+e),ee(d,s),m.extensions&&$(i,d,m),t.assignFinalMaterial(d),c.push(d)}for(let r=0,i=c.length;r<i;r++)t.associations.set(c[r],{meshes:e,primitives:r});if(1===c.length)return s.extensions&&$(i,c[0],s),c[0];let d=new n.Group;s.extensions&&$(i,d,s),t.associations.set(d,{meshes:e});for(let e=0,t=c.length;e<t;e++)d.add(c[e]);return d})}loadCamera(e){let t;let r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?t=new n.PerspectiveCamera(n.MathUtils.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===r.type&&(t=new n.OrthographicCamera(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),ee(t,r),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],r=[];for(let e=0,i=t.joints.length;e<i;e++)r.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(e){let r=e.pop(),i=[],s=[];for(let a=0,o=e.length;a<o;a++){let o=e[a];if(o){i.push(o);let e=new n.Matrix4;null!==r&&e.fromArray(r.array,16*a),s.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}return new n.Skeleton(i,s)})}loadAnimation(e){let t=this.json,r=this,i=t.animations[e],s=i.name?i.name:"animation_"+e,a=[],o=[],l=[],h=[],c=[];for(let e=0,t=i.channels.length;e<t;e++){let t=i.channels[e],r=i.samplers[t.sampler],n=t.target,s=n.node,d=void 0!==i.parameters?i.parameters[r.input]:r.input,u=void 0!==i.parameters?i.parameters[r.output]:r.output;void 0!==n.node&&(a.push(this.getDependency("node",s)),o.push(this.getDependency("accessor",d)),l.push(this.getDependency("accessor",u)),h.push(r),c.push(n))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l),Promise.all(h),Promise.all(c)]).then(function(e){let t=e[0],i=e[1],a=e[2],o=e[3],l=e[4],h=[];for(let e=0,n=t.length;e<n;e++){let n=t[e],s=i[e],c=a[e],d=o[e],u=l[e];if(void 0===n)continue;n.updateMatrix&&n.updateMatrix();let m=r._createAnimationTracks(n,s,c,d,u);if(m)for(let e=0;e<m.length;e++)h.push(m[e])}return new n.AnimationClip(s,void 0,h)})}createNodeMesh(e){let t=this.json,r=this,i=t.nodes[e];return void 0===i.mesh?null:r.getDependency("mesh",i.mesh).then(function(e){let t=r._getNodeRef(r.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,r=i.weights.length;t<r;t++)e.morphTargetInfluences[t]=i.weights[t]}),t})}loadNode(e){let t=this.json.nodes[e],r=this._loadNodeShallow(e),i=[],n=t.children||[];for(let e=0,t=n.length;e<t;e++)i.push(this.getDependency("node",n[e]));let s=void 0===t.skin?Promise.resolve(null):this.getDependency("skin",t.skin);return Promise.all([r,Promise.all(i),s]).then(function(e){let t=e[0],r=e[1],i=e[2];null!==i&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(i,ei)});for(let e=0,i=r.length;e<i;e++)t.add(r[e]);return t})}_loadNodeShallow(e){let t=this.json,r=this.extensions,i=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let s=t.nodes[e],a=s.name?i.createUniqueName(s.name):"",o=[],l=i._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return l&&o.push(l),void 0!==s.camera&&o.push(i.getDependency("camera",s.camera).then(function(e){return i._getNodeRef(i.cameraCache,s.camera,e)})),i._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){o.push(e)}),this.nodeCache[e]=Promise.all(o).then(function(t){let o;if((o=!0===s.isBone?new n.Bone:t.length>1?new n.Group:1===t.length?t[0]:new n.Object3D)!==t[0])for(let e=0,r=t.length;e<r;e++)o.add(t[e]);if(s.name&&(o.userData.name=s.name,o.name=a),ee(o,s),s.extensions&&$(r,o,s),void 0!==s.matrix){let e=new n.Matrix4;e.fromArray(s.matrix),o.applyMatrix4(e)}else void 0!==s.translation&&o.position.fromArray(s.translation),void 0!==s.rotation&&o.quaternion.fromArray(s.rotation),void 0!==s.scale&&o.scale.fromArray(s.scale);return i.associations.has(o)||i.associations.set(o,{}),i.associations.get(o).nodes=e,o}),this.nodeCache[e]}loadScene(e){let t=this.extensions,r=this.json.scenes[e],i=this,s=new n.Group;r.name&&(s.name=i.createUniqueName(r.name)),ee(s,r),r.extensions&&$(t,s,r);let a=r.nodes||[],o=[];for(let e=0,t=a.length;e<t;e++)o.push(i.getDependency("node",a[e]));return Promise.all(o).then(function(e){for(let t=0,r=e.length;t<r;t++)s.add(e[t]);return i.associations=(e=>{let t=new Map;for(let[e,r]of i.associations)(e instanceof n.Material||e instanceof n.Texture)&&t.set(e,r);return e.traverse(e=>{let r=i.associations.get(e);null!=r&&t.set(e,r)}),t})(s),s})}_createAnimationTracks(e,t,r,i,s){let a;let o=[],l=e.name?e.name:e.uuid,h=[];switch(Z[s.path]===Z.weights?e.traverse(function(e){e.morphTargetInfluences&&h.push(e.name?e.name:e.uuid)}):h.push(l),Z[s.path]){case Z.weights:a=n.NumberKeyframeTrack;break;case Z.rotation:a=n.QuaternionKeyframeTrack;break;case Z.position:case Z.scale:a=n.VectorKeyframeTrack;break;default:a=1===r.itemSize?n.NumberKeyframeTrack:n.VectorKeyframeTrack}let c=void 0!==i.interpolation?W[i.interpolation]:n.InterpolateLinear,d=this._getArrayFromAccessor(r);for(let e=0,r=h.length;e<r;e++){let r=new a(h[e]+"."+Z[s.path],t.array,d,c);"CUBICSPLINE"===i.interpolation&&this._createCubicSplineTrackInterpolant(r),o.push(r)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let e=er(t.constructor),r=new Float32Array(t.length);for(let i=0,n=t.length;i<n;i++)r[i]=t[i]*e;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof n.QuaternionKeyframeTrack?K:N)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function es(e,t,r){let i=t.attributes,s=[];for(let t in i){let n=z[t]||t.toLowerCase();n in e.attributes||s.push(function(t,i){return r.getDependency("accessor",t).then(function(t){e.setAttribute(i,t)})}(i[t],n))}if(void 0!==t.indices&&!e.index){let i=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});s.push(i)}return ee(e,t),!function(e,t,r){let i=t.attributes,s=new n.Box3;if(void 0===i.POSITION)return;{let e=r.json.accessors[i.POSITION],t=e.min,a=e.max;if(void 0!==t&&void 0!==a){if(s.set(new n.Vector3(t[0],t[1],t[2]),new n.Vector3(a[0],a[1],a[2])),e.normalized){let t=er(j[e.componentType]);s.min.multiplyScalar(t),s.max.multiplyScalar(t)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let a=t.targets;if(void 0!==a){let e=new n.Vector3,t=new n.Vector3;for(let i=0,n=a.length;i<n;i++){let n=a[i];if(void 0!==n.POSITION){let i=r.json.accessors[n.POSITION],s=i.min,a=i.max;if(void 0!==s&&void 0!==a){if(t.setX(Math.max(Math.abs(s[0]),Math.abs(a[0]))),t.setY(Math.max(Math.abs(s[1]),Math.abs(a[1]))),t.setZ(Math.max(Math.abs(s[2]),Math.abs(a[2]))),i.normalized){let e=er(j[i.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(e)}e.boundingBox=s;let o=new n.Sphere;s.getCenter(o.center),o.radius=s.min.distanceTo(s.max)/2,e.boundingSphere=o}(e,t,r),Promise.all(s).then(function(){return void 0!==t.targets?function(e,t,r){let i=!1,n=!1,s=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(void 0!==r.POSITION&&(i=!0),void 0!==r.NORMAL&&(n=!0),void 0!==r.COLOR_0&&(s=!0),i&&n&&s)break}if(!i&&!n&&!s)return Promise.resolve(e);let a=[],o=[],l=[];for(let h=0,c=t.length;h<c;h++){let c=t[h];if(i){let t=void 0!==c.POSITION?r.getDependency("accessor",c.POSITION):e.attributes.position;a.push(t)}if(n){let t=void 0!==c.NORMAL?r.getDependency("accessor",c.NORMAL):e.attributes.normal;o.push(t)}if(s){let t=void 0!==c.COLOR_0?r.getDependency("accessor",c.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l)]).then(function(t){let r=t[0],a=t[1],o=t[2];return i&&(e.morphAttributes.position=r),n&&(e.morphAttributes.normal=a),s&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}var ea=r(9473);let eo=null,el="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function eh(e,t,r){return i=>{r&&r(i),e&&(eo||(eo=new a),eo.setDecoderPath("string"==typeof e?e:el),i.setDRACOLoader(eo)),t&&i.setMeshoptDecoder("function"==typeof l?l():l)}}function ec(e,t=!0,r=!0,i){return(0,ea.F)(A,e,eh(t,r,i))}ec.preload=(e,t=!0,r=!0,i)=>ea.F.preload(A,e,eh(t,r,i)),ec.clear=e=>ea.F.clear(A,e),ec.setDecoderPath=e=>{el=e}},6547:function(e,t,r){"use strict";r.d(t,{z:function(){return p}});var i=r(2988),n=r(9473),s=r(2265),a=r(7776),o=Object.defineProperty,l=(e,t,r)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t,r)=>(l(e,"symbol"!=typeof t?t+"":t,r),r);let c=new a.Ray,d=new a.Plane,u=Math.cos(Math.PI/180*70),m=(e,t)=>(e%t+t)%t;class A extends a.EventDispatcher{constructor(e,t){super(),h(this,"object"),h(this,"domElement"),h(this,"enabled",!0),h(this,"target",new a.Vector3),h(this,"minDistance",0),h(this,"maxDistance",1/0),h(this,"minZoom",0),h(this,"maxZoom",1/0),h(this,"minPolarAngle",0),h(this,"maxPolarAngle",Math.PI),h(this,"minAzimuthAngle",-1/0),h(this,"maxAzimuthAngle",1/0),h(this,"enableDamping",!1),h(this,"dampingFactor",.05),h(this,"enableZoom",!0),h(this,"zoomSpeed",1),h(this,"enableRotate",!0),h(this,"rotateSpeed",1),h(this,"enablePan",!0),h(this,"panSpeed",1),h(this,"screenSpacePanning",!0),h(this,"keyPanSpeed",7),h(this,"zoomToCursor",!1),h(this,"autoRotate",!1),h(this,"autoRotateSpeed",2),h(this,"reverseOrbit",!1),h(this,"reverseHorizontalOrbit",!1),h(this,"reverseVerticalOrbit",!1),h(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),h(this,"mouseButtons",{LEFT:a.MOUSE.ROTATE,MIDDLE:a.MOUSE.DOLLY,RIGHT:a.MOUSE.PAN}),h(this,"touches",{ONE:a.TOUCH.ROTATE,TWO:a.TOUCH.DOLLY_PAN}),h(this,"target0"),h(this,"position0"),h(this,"zoom0"),h(this,"_domElementKeyEvents",null),h(this,"getPolarAngle"),h(this,"getAzimuthalAngle"),h(this,"setPolarAngle"),h(this,"setAzimuthalAngle"),h(this,"getDistance"),h(this,"listenToKeyEvents"),h(this,"stopListenToKeyEvents"),h(this,"saveState"),h(this,"reset"),h(this,"update"),h(this,"connect"),h(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>p.phi,this.getAzimuthalAngle=()=>p.theta,this.setPolarAngle=e=>{let t=m(e,2*Math.PI),i=p.phi;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let n=Math.abs(t-i);2*Math.PI-n<n&&(t<i?t+=2*Math.PI:i+=2*Math.PI),f.phi=t-i,r.update()},this.setAzimuthalAngle=e=>{let t=m(e,2*Math.PI),i=p.theta;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let n=Math.abs(t-i);2*Math.PI-n<n&&(t<i?t+=2*Math.PI:i+=2*Math.PI),f.theta=t-i,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",et),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",et),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),l=o.NONE},this.update=(()=>{let t=new a.Vector3,n=new a.Vector3(0,1,0),s=new a.Quaternion().setFromUnitVectors(e.up,n),h=s.clone().invert(),m=new a.Vector3,C=new a.Quaternion,_=2*Math.PI;return function(){let v=r.object.position;s.setFromUnitVectors(e.up,n),h.copy(s).invert(),t.copy(v).sub(r.target),t.applyQuaternion(s),p.setFromVector3(t),r.autoRotate&&l===o.NONE&&U(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(p.theta+=f.theta*r.dampingFactor,p.phi+=f.phi*r.dampingFactor):(p.theta+=f.theta,p.phi+=f.phi);let E=r.minAzimuthAngle,y=r.maxAzimuthAngle;isFinite(E)&&isFinite(y)&&(E<-Math.PI?E+=_:E>Math.PI&&(E-=_),y<-Math.PI?y+=_:y>Math.PI&&(y-=_),E<=y?p.theta=Math.max(E,Math.min(y,p.theta)):p.theta=p.theta>(E+y)/2?Math.max(E,p.theta):Math.min(y,p.theta)),p.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,p.phi)),p.makeSafe(),!0===r.enableDamping?r.target.addScaledVector(g,r.dampingFactor):r.target.add(g),r.zoomToCursor&&O||r.object.isOrthographicCamera?p.radius=k(p.radius):p.radius=k(p.radius*B),t.setFromSpherical(p),t.applyQuaternion(h),v.copy(r.target).add(t),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),!0===r.enableDamping?(f.theta*=1-r.dampingFactor,f.phi*=1-r.dampingFactor,g.multiplyScalar(1-r.dampingFactor)):(f.set(0,0,0),g.set(0,0,0));let T=!1;if(r.zoomToCursor&&O){let i=null;if(r.object instanceof a.PerspectiveCamera&&r.object.isPerspectiveCamera){let e=t.length();i=k(e*B);let n=e-i;r.object.position.addScaledVector(b,n),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){let e=new a.Vector3(D.x,D.y,0);e.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/B)),r.object.updateProjectionMatrix(),T=!0;let n=new a.Vector3(D.x,D.y,0);n.unproject(r.object),r.object.position.sub(n).add(e),r.object.updateMatrixWorld(),i=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;null!==i&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(i).add(r.object.position):(c.origin.copy(r.object.position),c.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(c.direction))<u?e.lookAt(r.target):(d.setFromNormalAndCoplanarPoint(r.object.up,r.target),c.intersectPlane(d,r.target))))}else r.object instanceof a.OrthographicCamera&&r.object.isOrthographicCamera&&(T=1!==B)&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/B)),r.object.updateProjectionMatrix());return B=1,O=!1,!!(T||m.distanceToSquared(r.object.position)>A||8*(1-C.dot(r.object.quaternion))>A)&&(r.dispatchEvent(i),m.copy(r.object.position),C.copy(r.object.quaternion),T=!1,!0)}})(),this.connect=e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),r.domElement=e,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",er),r.domElement.addEventListener("pointerdown",W),r.domElement.addEventListener("pointercancel",$),r.domElement.addEventListener("wheel",ee)},this.dispose=()=>{var e,t,i,n,s,a;r.domElement&&(r.domElement.style.touchAction="auto"),null==(e=r.domElement)||e.removeEventListener("contextmenu",er),null==(t=r.domElement)||t.removeEventListener("pointerdown",W),null==(i=r.domElement)||i.removeEventListener("pointercancel",$),null==(n=r.domElement)||n.removeEventListener("wheel",ee),null==(s=r.domElement)||s.ownerDocument.removeEventListener("pointermove",q),null==(a=r.domElement)||a.ownerDocument.removeEventListener("pointerup",$),null!==r._domElementKeyEvents&&r._domElementKeyEvents.removeEventListener("keydown",et)};let r=this,i={type:"change"},n={type:"start"},s={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},l=o.NONE,A=1e-6,p=new a.Spherical,f=new a.Spherical,B=1,g=new a.Vector3,C=new a.Vector2,_=new a.Vector2,v=new a.Vector2,E=new a.Vector2,y=new a.Vector2,T=new a.Vector2,M=new a.Vector2,F=new a.Vector2,R=new a.Vector2,b=new a.Vector3,D=new a.Vector2,O=!1,x=[],I={};function w(){return Math.pow(.95,r.zoomSpeed)}function U(e){r.reverseOrbit||r.reverseHorizontalOrbit?f.theta+=e:f.theta-=e}function H(e){r.reverseOrbit||r.reverseVerticalOrbit?f.phi+=e:f.phi-=e}let G=(()=>{let e=new a.Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),g.add(e)}})(),L=(()=>{let e=new a.Vector3;return function(t,i){!0===r.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),g.add(e)}})(),S=(()=>{let e=new a.Vector3;return function(t,i){let n=r.domElement;if(n&&r.object instanceof a.PerspectiveCamera&&r.object.isPerspectiveCamera){let s=r.object.position;e.copy(s).sub(r.target);let a=e.length();G(2*t*(a*=Math.tan(r.object.fov/2*Math.PI/180))/n.clientHeight,r.object.matrix),L(2*i*a/n.clientHeight,r.object.matrix)}else n&&r.object instanceof a.OrthographicCamera&&r.object.isOrthographicCamera?(G(t*(r.object.right-r.object.left)/r.object.zoom/n.clientWidth,r.object.matrix),L(i*(r.object.top-r.object.bottom)/r.object.zoom/n.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function P(e){r.object instanceof a.PerspectiveCamera&&r.object.isPerspectiveCamera||r.object instanceof a.OrthographicCamera&&r.object.isOrthographicCamera?B/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function J(e){r.object instanceof a.PerspectiveCamera&&r.object.isPerspectiveCamera||r.object instanceof a.OrthographicCamera&&r.object.isOrthographicCamera?B*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function N(e){if(!r.zoomToCursor||!r.domElement)return;O=!0;let t=r.domElement.getBoundingClientRect(),i=e.clientX-t.left,n=e.clientY-t.top,s=t.width,a=t.height;D.x=i/s*2-1,D.y=-(n/a*2)+1,b.set(D.x,D.y,1).unproject(r.object).sub(r.object.position).normalize()}function k(e){return Math.max(r.minDistance,Math.min(r.maxDistance,e))}function K(e){C.set(e.clientX,e.clientY)}function Q(e){E.set(e.clientX,e.clientY)}function j(){if(1==x.length)C.set(x[0].pageX,x[0].pageY);else{let e=.5*(x[0].pageX+x[1].pageX),t=.5*(x[0].pageY+x[1].pageY);C.set(e,t)}}function Y(){if(1==x.length)E.set(x[0].pageX,x[0].pageY);else{let e=.5*(x[0].pageX+x[1].pageX),t=.5*(x[0].pageY+x[1].pageY);E.set(e,t)}}function X(){let e=x[0].pageX-x[1].pageX,t=x[0].pageY-x[1].pageY;M.set(0,Math.sqrt(e*e+t*t))}function V(e){if(1==x.length)_.set(e.pageX,e.pageY);else{let t=en(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);_.set(r,i)}v.subVectors(_,C).multiplyScalar(r.rotateSpeed);let t=r.domElement;t&&(U(2*Math.PI*v.x/t.clientHeight),H(2*Math.PI*v.y/t.clientHeight)),C.copy(_)}function z(e){if(1==x.length)y.set(e.pageX,e.pageY);else{let t=en(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);y.set(r,i)}T.subVectors(y,E).multiplyScalar(r.panSpeed),S(T.x,T.y),E.copy(y)}function Z(e){let t=en(e),i=e.pageX-t.x,n=e.pageY-t.y;F.set(0,Math.sqrt(i*i+n*n)),R.set(0,Math.pow(F.y/M.y,r.zoomSpeed)),P(R.y),M.copy(F)}function W(e){var t,i;!1!==r.enabled&&(0===x.length&&(null==(t=r.domElement)||t.ownerDocument.addEventListener("pointermove",q),null==(i=r.domElement)||i.ownerDocument.addEventListener("pointerup",$)),x.push(e),"touch"===e.pointerType?function(e){switch(ei(e),x.length){case 1:switch(r.touches.ONE){case a.TOUCH.ROTATE:if(!1===r.enableRotate)return;j(),l=o.TOUCH_ROTATE;break;case a.TOUCH.PAN:if(!1===r.enablePan)return;Y(),l=o.TOUCH_PAN;break;default:l=o.NONE}break;case 2:switch(r.touches.TWO){case a.TOUCH.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&X(),r.enablePan&&Y(),l=o.TOUCH_DOLLY_PAN;break;case a.TOUCH.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&X(),r.enableRotate&&j(),l=o.TOUCH_DOLLY_ROTATE;break;default:l=o.NONE}break;default:l=o.NONE}l!==o.NONE&&r.dispatchEvent(n)}(e):function(e){let t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case a.MOUSE.DOLLY:if(!1===r.enableZoom)return;N(e),M.set(e.clientX,e.clientY),l=o.DOLLY;break;case a.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;Q(e),l=o.PAN}else{if(!1===r.enableRotate)return;K(e),l=o.ROTATE}break;case a.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;K(e),l=o.ROTATE}else{if(!1===r.enablePan)return;Q(e),l=o.PAN}break;default:l=o.NONE}l!==o.NONE&&r.dispatchEvent(n)}(e))}function q(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(ei(e),l){case o.TOUCH_ROTATE:if(!1===r.enableRotate)return;V(e),r.update();break;case o.TOUCH_PAN:if(!1===r.enablePan)return;z(e),r.update();break;case o.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&Z(e),r.enablePan&&z(e),r.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&Z(e),r.enableRotate&&V(e),r.update();break;default:l=o.NONE}}(e):function(e){if(!1!==r.enabled)switch(l){case o.ROTATE:if(!1===r.enableRotate)return;!function(e){_.set(e.clientX,e.clientY),v.subVectors(_,C).multiplyScalar(r.rotateSpeed);let t=r.domElement;t&&(U(2*Math.PI*v.x/t.clientHeight),H(2*Math.PI*v.y/t.clientHeight)),C.copy(_),r.update()}(e);break;case o.DOLLY:if(!1===r.enableZoom)return;F.set(e.clientX,e.clientY),R.subVectors(F,M),R.y>0?P(w()):R.y<0&&J(w()),M.copy(F),r.update();break;case o.PAN:if(!1===r.enablePan)return;y.set(e.clientX,e.clientY),T.subVectors(y,E).multiplyScalar(r.panSpeed),S(T.x,T.y),E.copy(y),r.update()}}(e))}function $(e){var t,i,n;(function(e){delete I[e.pointerId];for(let t=0;t<x.length;t++)if(x[t].pointerId==e.pointerId){x.splice(t,1);return}})(e),0===x.length&&(null==(t=r.domElement)||t.releasePointerCapture(e.pointerId),null==(i=r.domElement)||i.ownerDocument.removeEventListener("pointermove",q),null==(n=r.domElement)||n.ownerDocument.removeEventListener("pointerup",$)),r.dispatchEvent(s),l=o.NONE}function ee(e){!1!==r.enabled&&!1!==r.enableZoom&&(l===o.NONE||l===o.ROTATE)&&(e.preventDefault(),r.dispatchEvent(n),N(e),e.deltaY<0?J(w()):e.deltaY>0&&P(w()),r.update(),r.dispatchEvent(s))}function et(e){!1!==r.enabled&&!1!==r.enablePan&&function(e){let t=!1;switch(e.code){case r.keys.UP:S(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:S(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:S(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:S(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}(e)}function er(e){!1!==r.enabled&&e.preventDefault()}function ei(e){let t=I[e.pointerId];void 0===t&&(t=new a.Vector2,I[e.pointerId]=t),t.set(e.pageX,e.pageY)}function en(e){return I[(e.pointerId===x[0].pointerId?x[1]:x[0]).pointerId]}void 0!==t&&this.connect(t),this.update()}}let p=s.forwardRef(({makeDefault:e,camera:t,regress:r,domElement:a,enableDamping:o=!0,keyEvents:l=!1,onChange:h,onStart:c,onEnd:d,...u},m)=>{let p=(0,n.A)(e=>e.invalidate),f=(0,n.A)(e=>e.camera),B=(0,n.A)(e=>e.gl),g=(0,n.A)(e=>e.events),C=(0,n.A)(e=>e.setEvents),_=(0,n.A)(e=>e.set),v=(0,n.A)(e=>e.get),E=(0,n.A)(e=>e.performance),y=t||f,T=a||g.connected||B.domElement,M=s.useMemo(()=>new A(y),[y]);return(0,n.C)(()=>{M.enabled&&M.update()},-1),s.useEffect(()=>(l&&M.connect(!0===l?T:l),M.connect(T),()=>void M.dispose()),[l,T,r,M,p]),s.useEffect(()=>{let e=e=>{p(),r&&E.regress(),h&&h(e)},t=e=>{c&&c(e)},i=e=>{d&&d(e)};return M.addEventListener("change",e),M.addEventListener("start",t),M.addEventListener("end",i),()=>{M.removeEventListener("start",t),M.removeEventListener("end",i),M.removeEventListener("change",e)}},[h,c,d,M,p,C]),s.useEffect(()=>{if(e){let e=v().controls;return _({controls:M}),()=>_({controls:e})}},[e,M]),s.createElement("primitive",(0,i.Z)({ref:m,object:M,enableDamping:o},u))})},8063:function(e,t,r){"use strict";r.d(t,{q:function(){return A}});var i=r(2988),n=r(2265),s=r(7776),a=r(6231),o=Object.defineProperty,l=(e,t,r)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t,r)=>(l(e,"symbol"!=typeof t?t+"":t,r),r);let c={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new s.Vector3},up:{value:new s.Vector3(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${a.i>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},d=new s.ShaderMaterial({name:"SkyShader",fragmentShader:c.fragmentShader,vertexShader:c.vertexShader,uniforms:s.UniformsUtils.clone(c.uniforms),side:s.BackSide,depthWrite:!1});class u extends s.Mesh{constructor(){super(new s.BoxGeometry(1,1,1),d)}}function m(e,t,r=new s.Vector3){let i=2*Math.PI*(t-.5);return r.x=Math.cos(i),r.y=Math.sin(Math.PI*(e-.5)),r.z=Math.sin(i),r}h(u,"SkyShader",c),h(u,"material",d);let A=n.forwardRef(({inclination:e=.6,azimuth:t=.1,distance:r=1e3,mieCoefficient:a=.005,mieDirectionalG:o=.8,rayleigh:l=.5,turbidity:h=10,sunPosition:c=m(e,t),...d},A)=>{let p=n.useMemo(()=>new s.Vector3().setScalar(r),[r]),[f]=n.useState(()=>new u);return n.createElement("primitive",(0,i.Z)({object:f,ref:A,"material-uniforms-mieCoefficient-value":a,"material-uniforms-mieDirectionalG-value":o,"material-uniforms-rayleigh-value":l,"material-uniforms-sunPosition-value":c,"material-uniforms-turbidity-value":h,scale:p},d))})},6078:function(e,t,r){"use strict";r.d(t,{Jj:function(){return i},kn:function(){return s},rn:function(){return n}});let i=(e,t)=>{"updateRanges"in e?e.updateRanges[0]=t:e.updateRange=t},n=3e3,s=3001},2325:function(e,t,r){"use strict";let i,n;r.d(t,{V:function(){return C}});var s=r(2988),a=r(2265),o=r(4040),l=r(7776),h=r(9473);let c=new l.Vector3,d=new l.Vector3,u=new l.Vector3,m=new l.Vector2;function A(e,t,r){let i=c.setFromMatrixPosition(e.matrixWorld);i.project(t);let n=r.width/2,s=r.height/2;return[i.x*n+n,-(i.y*s)+s]}let p=e=>1e-10>Math.abs(e)?0:e;function f(e,t,r=""){let i="matrix3d(";for(let r=0;16!==r;r++)i+=p(t[r]*e.elements[r])+(15!==r?",":")");return r+i}let B=(i=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>f(e,i)),g=(n=e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1],(e,t)=>f(e,n(t),"translate(-50%,-50%)")),C=a.forwardRef(({children:e,eps:t=.001,style:r,className:i,prepend:n,center:f,fullscreen:C,portal:_,distanceFactor:v,sprite:E=!1,transform:y=!1,occlude:T,onOcclude:M,castShadow:F,receiveShadow:R,material:b,geometry:D,zIndexRange:O=[16777271,0],calculatePosition:x=A,as:I="div",wrapperClass:w,pointerEvents:U="auto",...H},G)=>{let{gl:L,camera:S,scene:P,size:J,raycaster:N,events:k,viewport:K}=(0,h.A)(),[Q]=a.useState(()=>document.createElement(I)),j=a.useRef(),Y=a.useRef(null),X=a.useRef(0),V=a.useRef([0,0]),z=a.useRef(null),Z=a.useRef(null),W=(null==_?void 0:_.current)||k.connected||L.domElement.parentNode,q=a.useRef(null),$=a.useRef(!1),ee=a.useMemo(()=>{var e;return T&&"blending"!==T||Array.isArray(T)&&T.length&&(e=T[0])&&"object"==typeof e&&"current"in e},[T]);a.useLayoutEffect(()=>{let e=L.domElement;T&&"blending"===T?(e.style.zIndex=`${Math.floor(O[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)},[T]),a.useLayoutEffect(()=>{if(Y.current){let e=j.current=o.createRoot(Q);if(P.updateMatrixWorld(),y)Q.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{let e=x(Y.current,S,J);Q.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return W&&(n?W.prepend(Q):W.appendChild(Q)),()=>{W&&W.removeChild(Q),e.unmount()}}},[W,y]),a.useLayoutEffect(()=>{w&&(Q.className=w)},[w]);let et=a.useMemo(()=>y?{position:"absolute",top:0,left:0,width:J.width,height:J.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:f?"translate3d(-50%,-50%,0)":"none",...C&&{top:-J.height/2,left:-J.width/2,width:J.width,height:J.height},...r},[r,f,C,J,y]),er=a.useMemo(()=>({position:"absolute",pointerEvents:U}),[U]);a.useLayoutEffect(()=>{var t,n;$.current=!1,y?null==(t=j.current)||t.render(a.createElement("div",{ref:z,style:et},a.createElement("div",{ref:Z,style:er},a.createElement("div",{ref:G,className:i,style:r,children:e})))):null==(n=j.current)||n.render(a.createElement("div",{ref:G,style:et,className:i,children:e}))});let ei=a.useRef(!0);(0,h.C)(e=>{if(Y.current){S.updateMatrixWorld(),Y.current.updateWorldMatrix(!0,!1);let e=y?V.current:x(Y.current,S,J);if(y||Math.abs(X.current-S.zoom)>t||Math.abs(V.current[0]-e[0])>t||Math.abs(V.current[1]-e[1])>t){let t=function(e,t){let r=c.setFromMatrixPosition(e.matrixWorld),i=d.setFromMatrixPosition(t.matrixWorld),n=r.sub(i),s=t.getWorldDirection(u);return n.angleTo(s)>Math.PI/2}(Y.current,S),r=!1;ee&&(Array.isArray(T)?r=T.map(e=>e.current):"blending"!==T&&(r=[P]));let i=ei.current;if(r){let e=function(e,t,r,i){let n=c.setFromMatrixPosition(e.matrixWorld),s=n.clone();s.project(t),m.set(s.x,s.y),r.setFromCamera(m,t);let a=r.intersectObjects(i,!0);if(a.length){let e=a[0].distance;return n.distanceTo(r.ray.origin)<e}return!0}(Y.current,S,N,r);ei.current=e&&!t}else ei.current=!t;i!==ei.current&&(M?M(!ei.current):Q.style.display=ei.current?"block":"none");let n=Math.floor(O[0]/2),s=T?ee?[O[0],n]:[n-1,0]:O;if(Q.style.zIndex=`${function(e,t,r){if(t instanceof l.PerspectiveCamera||t instanceof l.OrthographicCamera){let i=c.setFromMatrixPosition(e.matrixWorld),n=d.setFromMatrixPosition(t.matrixWorld),s=i.distanceTo(n),a=(r[1]-r[0])/(t.far-t.near),o=r[1]-a*t.far;return Math.round(a*s+o)}}(Y.current,S,s)}`,y){let[e,t]=[J.width/2,J.height/2],r=S.projectionMatrix.elements[5]*t,{isOrthographicCamera:i,top:n,left:s,bottom:a,right:o}=S,l=B(S.matrixWorldInverse),h=i?`scale(${r})translate(${p(-(o+s)/2)}px,${p((n+a)/2)}px)`:`translateZ(${r}px)`,c=Y.current.matrixWorld;E&&((c=S.matrixWorldInverse.clone().transpose().copyPosition(c).scale(Y.current.scale)).elements[3]=c.elements[7]=c.elements[11]=0,c.elements[15]=1),Q.style.width=J.width+"px",Q.style.height=J.height+"px",Q.style.perspective=i?"":`${r}px`,z.current&&Z.current&&(z.current.style.transform=`${h}${l}translate(${e}px,${t}px)`,Z.current.style.transform=g(c,1/((v||10)/400)))}else{let t=void 0===v?1:function(e,t){if(t instanceof l.OrthographicCamera)return t.zoom;if(!(t instanceof l.PerspectiveCamera))return 1;{let r=c.setFromMatrixPosition(e.matrixWorld),i=d.setFromMatrixPosition(t.matrixWorld);return 1/(2*Math.tan(t.fov*Math.PI/180/2)*r.distanceTo(i))}}(Y.current,S)*v;Q.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}V.current=e,X.current=S.zoom}}if(!ee&&q.current&&!$.current){if(y){if(z.current){let e=z.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){let{isOrthographicCamera:t}=S;if(t||D)H.scale&&(Array.isArray(H.scale)?H.scale instanceof l.Vector3?q.current.scale.copy(H.scale.clone().divideScalar(1)):q.current.scale.set(1/H.scale[0],1/H.scale[1],1/H.scale[2]):q.current.scale.setScalar(1/H.scale));else{let t=(v||10)/400,r=e.clientWidth*t,i=e.clientHeight*t;q.current.scale.set(r,i,1)}$.current=!0}}}else{let t=Q.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){let e=1/K.factor,r=t.clientWidth*e,i=t.clientHeight*e;q.current.scale.set(r,i,1),$.current=!0}q.current.lookAt(e.camera.position)}}});let en=a.useMemo(()=>({vertexShader:y?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[y]);return a.createElement("group",(0,s.Z)({},H,{ref:Y}),T&&!ee&&a.createElement("mesh",{castShadow:F,receiveShadow:R,ref:q},D||a.createElement("planeGeometry",null),b||a.createElement("shaderMaterial",{side:l.DoubleSide,vertexShader:en.vertexShader,fragmentShader:en.fragmentShader})))})},1207:function(){},6231:function(e,t,r){"use strict";r.d(t,{i:function(){return i}});let i=parseInt(r(7776).REVISION.replace(/\D+/g,""))}}]);